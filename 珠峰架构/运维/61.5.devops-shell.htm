<!DOCTYPE html>
<!-- saved from url=(0068)http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>珠峰架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="./61.5.devops-shell_files/main.css">
<style type="text/css" abt="234"></style><script>//console.log('a')
</script><script>//remove 17173 video ad
doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
//remove baidu search ad
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var aa = function(){
            var all = document.body.querySelectorAll("#content_left div,#content_left table");
            for(var i = 0; i < all.length; i++){
                if(/display:\s?(table|block)\s!important/.test(all[i].getAttribute("style"))){all[i].style.display= "none";all[i].style.visibility='hidden';}
            }
            all = document.body.querySelectorAll('.result.c-container[id="1"]');
            //if(all.length == 1) return;
            for(var i = 0; i < all.length; i++){
                if(all[i].innerHTML && all[i].innerHTML.indexOf('广告')>-1){
                    all[i].style.display= "none";all[i].style.visibility='hidden';
                }
            }
        }
        aa();
        document.getElementById('wrapper_wrapper').addEventListener('DOMSubtreeModified',aa)
    };
}
//remove sohu video ad
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//remove 56.com video ad
if (document.URL.indexOf("56.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//fore iqiyi enable html5 player function
if (document.URL.indexOf("iqiyi.com") >= 0){
    if (document.cookie.indexOf("player_forcedType=h5_VOD")==-1){
        document.cookie='player_forcedType=h5_VOD'
        if(localStorage.reloadTime && Date.now() - parseInt(localStorage.reloadTime)<60000){
            console.log('no reload')
        }else{
            location.reload()
            localStorage.reloadTime = Date.now();
        }
    }
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style></head>
<body>
<div class="nav" style="height: 81px;">
    <div class="logo">
        
            珠峰架构师成长计划
        
    </div>
<ul><li><a href="http://www.zhufengpeixun.cn/architecture/index.html">0.Async</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/0.editor.html">0.editor</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/0.module.html">0.module</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/1.ES2015.html">1.ES2015</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/2.Promise.html">2.Promise</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/3.Node.html">3.Node</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/4.NodeInstall.html">4.NodeInstall</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/5.REPL.html">5.REPL</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/6.NodeCore.html">6.NodeCore</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/7.module&amp;NPM.html">7.module&amp;NPM</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/8.Encoding.html">8.Encoding</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/9.Buffer.html">9.Buffer</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/10.fs.html">10.fs</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/11.Stream-1.html">11.Stream-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/11.Stream-2.html">11.Stream-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/11.Stream-3.html">11.Stream-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/11.Stream-4.html">11.Stream-4</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/12-Network-2.html">12-Network-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/12.NetWork-3.html">12.NetWork-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/12.Network-1.html">12.Network-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/13.tcp.html">13.tcp</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/14.http-1.html">14.http-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/14.http-2.html">14.http-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/15.compress.html">15.compress</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/16.crypto.html">16.crypto</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/17.process.html">17.process</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/18.yargs.html">18.yargs</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/19.cache.html">19.cache</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/20.action.html">20.action</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/21.https.html">21.https</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/22.cookie.html">22.cookie</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/23.session.html">23.session</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/24.express-1.html">24.express-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/24.express-2.html">24.express-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/24.express-3.html">24.express-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/24.express-4.html">24.express-4</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/25.koa-1.html">25.koa-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-1-basic.html">26.webpack-1-basic</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-2-optimize.html">26.webpack-2-optimize</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-3.tapable.html">26.webpack-3.tapable</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-4-AST.html">26.webpack-4-AST</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-5-source.html">26.webpack-5-source</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-6-loader.html">26.webpack-6-loader</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-7-plugin.html">26.webpack-7-plugin</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/26.webpack-8-hand.html">26.webpack-8-hand</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-1.html">27.react-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-2.html">27.react-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-3.html">27.react-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-4-immutable.html">27.react-4-immutable</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-5-react-dom-diff.html">27.react-5-react-dom-diff</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/27.react-6.html">27.react-6</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.react-mobx.html">28.react-mobx</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.redux-0.html">28.redux-0</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.redux-1.html">28.redux-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.redux-2-%E4%B8%AD%E9%97%B4%E4%BB%B6.html">28.redux-2-中间件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.redux-jwt-back.html">28.redux-jwt-back</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/28.redux-jwt-front.html">28.redux-jwt-front</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-1.html">29.mongodb-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-2.html">29.mongodb-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-3.html">29.mongodb-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-4.html">29.mongodb-4</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-5.html">29.mongodb-5</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/29.mongodb-6.html">29.mongodb-6</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-1-mysql.html">30.cms-1-mysql</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-2-mysql.html">30.cms-2-mysql</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-3-mysql.html">30.cms-3-mysql</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-4-nunjucks.html">30.cms-4-nunjucks</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-5-mock.html">30.cms-5-mock</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-6-egg.html">30.cms-6-egg</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-7-api.html">30.cms-7-api</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-8-roadhog.html">30.cms-8-roadhog</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-9-yaml.html">30.cms-9-yaml</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-10-umi.html">30.cms-10-umi</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-11-saga.html">30.cms-11-saga</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-12-dva.html">30.cms-12-dva</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-13-dva-ant.html">30.cms-13-dva-ant</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-14-front.html">30.cms-14-front</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/30.cms-15-deploy.html">30.cms-15-deploy</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/31.dva.html">31.dva</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/31.saga.html">31.saga</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/33.redis.html">33.redis</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/34.unittest.html">34.unittest</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/35.jwt.html">35.jwt</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/36.websocket-1.html">36.websocket-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/36.websocket-2.html">36.websocket-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat-api-1.html">38.chat-api-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat-api-2.html">38.chat-api-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat-3.html">38.chat-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat-api-3.html">38.chat-api-3</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat.html">38.chat</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat2.html">38.chat2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/38.chat2.html">38.chat2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/39.crawl-0.html">39.crawl-0</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/39.crawl-1.html">39.crawl-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/39.crawl-2.html">39.crawl-2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/40.deploy.html">40.deploy</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/41.safe.html">41.safe</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/42.test.html">42.test</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/43.nginx.html">43.nginx</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/44.enzyme.html">44.enzyme</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/45.docker.html">45.docker</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/46.elastic.html">46.elastic</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/47.oauth.html">47.oauth</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/48.wxpay.html">48.wxpay</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/index.html">index</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/51.typescript.html">51.typescript</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/52.UML.html">52.UML</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/53.design.html">53.design</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/index.html">index</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/54.linux.html">54.linux</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/57.ts.html">57.ts</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/56.react-ssr.html">56.react-ssr</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/58.ts_react.html">58.ts_react</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/59.ketang.html">59.ketang</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/59.ketang2.html">59.ketang2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/60.react.html">60.react</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/60.react-1.html">60.react-1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.1.devops-linux.html">61.1.devops-linux</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.2.devops-vi.html">61.2.devops-vi</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.3.devops-user.html">61.3.devops-user</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.4.devops-auth.html">61.4.devops-auth</a></li><li class="active"><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html">61.5.devops-shell</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.6.devops-install.html">61.6.devops-install</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.7.devops-system.html">61.7.devops-system</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.8.devops-service.html">61.8.devops-service</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.9.devops-network.html">61.9.devops-network</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.10.devops-nginx.html">61.10.devops-nginx</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.11.devops-docker.html">61.11.devops-docker</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.12.devops-jekins.html">61.12.devops-jekins</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.13.devops-groovy.html">61.13.devops-groovy</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.14.devops-php.html">61.14.devops-php</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.15.devops-java.html">61.15.devops-java</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.16.devops-node.html">61.16.devops-node</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/62.1.react-basic.html">62.1.react-basic</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/62.2.react-state.html">62.2.react-state</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/62.3.react-high.html">62.3.react-high</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/62.4.react-hooks.html">62.4.react-hooks</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/63.1.redux.html">63.1.redux</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/63.2.redux-middleware.html">63.2.redux-middleware</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/63.3.redux-saga.html">63.3.redux-saga</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/63.4.redux-saga-hand.html">63.4.redux-saga-hand</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/64.1.router.html">64.1.router</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/64.2.router-connected.html">64.2.router-connected</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/65.1.typescript.html">65.1.typescript</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/65.2.typescript.html">65.2.typescript</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/65.3.typescript.html">65.3.typescript</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/65.4.antd.html">65.4.antd</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-1.vue-base.html">66-1.vue-base</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-2.vue-component.html">66-2.vue-component</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-3.vue-cli3.0.html">66-3.vue-cli3.0</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-4.$message%E7%BB%84%E4%BB%B6.html">66-4.$message组件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-5.Form%E7%BB%84%E4%BB%B6.html">66-5.Form组件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-6.tree.html">66-6.tree</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-7.vue-router-apply.html">66-7.vue-router-apply</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-8.axios-apply.html">66-8.axios-apply</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-9.vuex-apply.html">66-9.vuex-apply</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-10.jwt-vue.html">66-10.jwt-vue</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-11.vue-ssr.html">66-11.vue-ssr</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-12.nuxt-apply.html">66-12.nuxt-apply</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-13.pwa.html">66-13.pwa</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-14.vue%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html">66-14.vue单元测试</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/66-15.%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C.html">66-15.权限校验</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/67-1-network.html">67-1-network</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/68-2-wireshark.html">68-2-wireshark</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/7.npm2.html">7.npm2</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/31.cms-13-dva-antdesign.html">31.cms-13-dva-antdesign</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/69-hooks.html">69-hooks</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/70-deploy.html">70-deploy</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.17.devops-k8s.html">61.17.devops-k8s</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/60.react-2.html">60.react-2</a></li></ul></div>


<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t01.%20shell%E5%9F%BA%E7%A1%80">1. shell基础</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t11.1%20%E6%9F%A5%E7%9C%8B%E6%94%AF%E6%8C%81%E7%9A%84shell">1.1 查看支持的shell</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t21.2%20echo">1.2 echo</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t31.3%20%E7%BC%96%E5%86%99%E6%89%A7%E8%A1%8Cshell">1.3 编写执行shell</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t41.4%20%E5%88%AB%E5%90%8D">1.4 别名</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t51.5%20%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%9F%E6%95%88%E9%A1%BA%E5%BA%8F">1.5 命令的生效顺序</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t61.6%20%E5%91%BD%E4%BB%A4%E5%BF%AB%E6%8D%B7%E9%94%AE">1.6 命令快捷键</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t71.7%20%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4">1.7 历史命令</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t81.8%20%E8%B0%83%E7%94%A8">1.8 调用</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t91.9%20%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91">1.9 输出重定向</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t101.9.1%20%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA">1.9.1 标准输入输出</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t111.9.2%20%E8%BE%93%E5%85%A5%E9%87%8D%E5%AE%9A%E5%90%91">1.9.2 输入重定向</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t121.10%20%E7%AE%A1%E9%81%93%E7%AC%A6%E5%8F%B7">1.10 管道符号</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t131.10.1%20%E5%A4%9A%E5%91%BD%E4%BB%A4%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C">1.10.1 多命令顺序执行</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t141.10.2%20%E7%AE%A1%E9%81%93%E7%AC%A6%E5%8F%B7">1.10.2 管道符号</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t151.10.3%20%E9%80%9A%E9%85%8D%E7%AC%A6">1.10.3 通配符</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t161.10.4%20%E5%85%B6%E5%AE%83%E7%AC%A6%E5%8F%B7">1.10.4 其它符号</a></li></ul></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t172.%20%E5%8F%98%E9%87%8F">2. 变量</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t182.1%20%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%98%E9%87%8F">2.1 什么是变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t192.2%20%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%86%E7%B1%BB">2.2 变量的分类</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t202.3%20%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F">2.3 用户自定义变量</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t212.3.1%20%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F">2.3.1 定义变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t222.3.2%20%E8%BE%93%E5%87%BA%E5%8F%98%E9%87%8F%E5%80%BC">2.3.2 输出变量值</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t232.3.3%20%E5%80%BC%E9%BB%98%E8%AE%A4%E9%83%BD%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2">2.3.3 值默认都是字符串</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t242.3.4%20%E5%9C%A8%E8%B5%8B%E5%80%BC%E7%9A%84%E6%97%B6%E5%80%99%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F">2.3.4 在赋值的时候引用变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t252.3.5%20set">2.3.5 set</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t262.3.6%20unset">2.3.6 unset</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t272.4%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">2.4 环境变量</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t282.4.1%20%E8%87%AA%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">2.4.1 自定义环境变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t292.4.2%20env">2.4.2 env</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t302.4.3%20%E5%B8%B8%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">2.4.3 常用环境变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t312.4.4%20path">2.4.4 path</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t322.4.5%20$PS1">2.4.5 $PS1</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t332.4.6%20%E8%AF%AD%E7%B3%BB%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">2.4.6 语系环境变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t342.4.7%20%E4%B8%AD%E6%96%87%E6%94%AF%E6%8C%81">2.4.7 中文支持</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t352.5%20%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%98%E9%87%8F">2.5 位置参数变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t362.6%20%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F">2.6 预定义变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t372.7%20read">2.7 read</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t383.%20%E8%BF%90%E7%AE%97%E7%AC%A6">3. 运算符</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t393.1%20declare%E5%91%BD%E4%BB%A4">3.1 declare命令</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t403.1.1%20declare%E5%91%BD%E4%BB%A4">3.1.1 declare命令</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t413.1.2%20%E6%95%B0%E7%BB%84">3.1.2 数组</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t423.1.3%20%E5%A3%B0%E6%98%8E%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">3.1.3 声明环境变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t433.1.4%20%E5%8F%AA%E8%AF%BB%E5%B1%9E%E6%80%A7">3.1.4 只读属性</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t443.1.5%20%E6%9F%A5%E8%AF%A2%E5%8F%98%E9%87%8F%E5%B1%9E%E6%80%A7">3.1.5 查询变量属性</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t453.2%20%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97%E7%9A%84%E6%96%B9%E6%B3%95">3.2 数值运算的方法</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t463.2.1%20expr%E6%88%96let">3.2.1 expr或let</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t473.2.2%20%E4%BC%98%E5%85%88%E7%BA%A7">3.2.2 优先级</a></li></ul></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t484.%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">4. 环境变量配置文件</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t494.1%20%20source%20%E5%91%BD%E4%BB%A4">4.1  source 命令</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t504.2%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%80%E4%BB%8B">4.2 环境变量配置文件简介</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t514.3%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%8A%9F%E8%83%BD">4.3 环境变量配置文件的功能</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t524.3.1%20/etc/profile">4.3.1 /etc/profile</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t534.3.2%20~/.bash_profile">4.3.2 ~/.bash_profile</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t544.3.3%20~/.bashrc">4.3.3 ~/.bashrc</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t554.3.4%20/etc/bashrc">4.3.4 /etc/bashrc</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t564.3.5.%20%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">4.3.5. 其它配置文件</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t574.3.5.1%20%E6%B3%A8%E9%94%80%E6%97%B6%E7%94%9F%E6%95%88%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">4.3.5.1 注销时生效的环境变量配置文件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t584.3.5.2%20%20%E8%84%9A%E6%9C%AC%E5%8E%86%E5%8F%B2">4.3.5.2  脚本历史</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t594.3.5.3%20Shell%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF">4.3.5.3 Shell登录信息</a></li></ul></li></ul></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t604.%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">4.正则表达式</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t614.1%20%E6%A6%82%E5%BF%B5">4.1 概念</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t624.2%20%E9%80%9A%E9%85%8D%E7%AC%A6">4.2 通配符</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t634.3%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">4.3 正则表达式</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t644.4%20%E5%85%83%E5%AD%97%E7%AC%A6">4.4 元字符</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t654.5%20cut">4.5 cut</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t664.6%20printf">4.6 printf</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t674.7%20awk">4.7 awk</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t684.7.1%20begin%20end">4.7.1 begin end</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t694.7.2%20FS">4.7.2 FS</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t704.7.3%20%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F">4.7.3 声明变量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t714.7.4%20%E5%A4%9A%E6%9D%A1%E4%BB%B6">4.7.4 多条件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t724.7.5%20NR">4.7.5 NR</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t734.7.6%20OFS">4.7.6 OFS</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t744.8%20sed%E5%91%BD%E4%BB%A4">4.8 sed命令</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t754.9%20%E6%8E%92%E5%BA%8F%E5%91%BD%E4%BB%A4sort">4.9 排序命令sort</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t764.10%20wc">4.10 wc</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t775.%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6">5. 流程控制</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t785.1%20%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD">5.1 条件判断</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t795.1.1%20%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD">5.1.1 按照文件类型进行判断</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t805.1.2%20%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD">5.1.2 按照文件权限进行判断</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t815.1.3%20%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E9%97%B4%E7%9A%84%E6%AF%94%E8%BE%83">5.1.3 两个文件间的比较</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t825.1.4%20%E4%B8%A4%E4%B8%AA%E6%95%B4%E6%95%B0%E9%97%B4%E7%9A%84%E6%AF%94%E8%BE%83">5.1.4 两个整数间的比较</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t835.1.5%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%88%A4%E6%96%AD">5.1.5 字符串的判断</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t845.1.6%20%E5%A4%9A%E9%87%8D%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD">5.1.6 多重条件判断</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t855.2%20%E5%8D%95%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5">5.2 单分支if语句</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t865.2.1%20%E8%AF%AD%E6%B3%95">5.2.1 语法</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t875.2.2%20%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E6%98%AFroot%E7%94%A8%E6%88%B7">5.2.2 判断当前用户是否是root用户</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t885.3%20%E5%8F%8C%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5">5.3 双分支if语句</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t895.3.1%20%E8%AF%AD%E6%B3%95">5.3.1 语法</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t905.3.2%20%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E7%9B%AE%E5%BD%95">5.3.2 判断是否目录</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t915.4%20%E5%A4%9A%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5">5.4 多分支if语句</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t925.4.1%20%E8%AF%AD%E6%B3%95">5.4.1 语法</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t935.5%20case%20%E8%AF%AD%E5%8F%A5">5.5 case 语句</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t945.5.1%20%E8%AF%AD%E6%B3%95">5.5.1 语法</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t955.6%20for%E5%BE%AA%E7%8E%AF">5.6 for循环</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t965.6.1%20%E8%AF%AD%E6%B3%95">5.6.1 语法</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t975.6.2%20%E8%AF%AD%E6%B3%95">5.6.2 语法</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t985.7%20while%E5%BE%AA%E7%8E%AF">5.7 while循环</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t995.8%20until%E5%BE%AA%E7%8E%AF">5.8 until循环</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1006.%20%E5%87%BD%E6%95%B0">6. 函数</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1016.1%20%E7%AE%80%E5%8D%95%E5%87%BD%E6%95%B0">6.1 简单函数</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1026.2%20%E8%BF%94%E5%9B%9E%E5%80%BC">6.2 返回值</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1036.3%20%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E">6.3 参数说明</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1046.4%20profile">6.4 profile</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1056.4.1%20%E8%84%9A%E6%9C%AC">6.4.1 脚本</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1066.4.2%20%E6%89%93%E5%8D%B0%E5%BD%93%E5%89%8Dshell%E7%9A%84%E9%80%89%E9%A1%B9">6.4.2 打印当前shell的选项</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1076.4.3%20%E9%80%89%E9%A1%B9">6.4.3 选项</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1086.4.3.1%20i%20-%20interactive">6.4.3.1 i - interactive</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1096.4.3.2%20H%20-%20history%20expand">6.4.3.2 H - history expand</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1106.4.3.3%20B%20-%20brace%20expansion">6.4.3.3 B - brace expansion</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1116.4.3.4%20m%20-%20monitor%20mode">6.4.3.4 m - monitor mode</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1126.4.3.5%20h%20-%20hashal">6.4.3.5 h - hashal</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1136.4.4%20%E5%88%A0%E9%99%A4">6.4.4 删除</a></li></ul></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1147.shell%E5%AE%9E%E6%88%98">7.shell实战</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1157.1%20%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">7.1 注意事项</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1167.2%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96%E6%95%B0%E5%AD%97">7.2 获取随机字符串或数字</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1177.2.1%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA8%E4%BD%8D%E5%AD%97%E7%AC%A6%E4%B8%B2">7.2.1 获取随机8位字符串</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1187.2.2%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA8%E4%BD%8D%E6%95%B0%E5%AD%97">7.2.2 获取随机8位数字</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1197.3%20%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E9%A2%9C%E8%89%B2%E8%BE%93%E5%87%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0">7.3 定义一个颜色输出字符串函数</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1207.4%20%E6%89%B9%E9%87%8F%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7">7.4 批量创建用户</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1217.5%20%E6%A3%80%E6%9F%A5%E4%B8%BB%E6%9C%BA%E5%AD%98%E6%B4%BB%E7%8A%B6%E6%80%81">7.5 检查主机存活状态</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1227.6%20%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7">7.6 系统监控</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1237.6.1%20%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4">7.6.1 系统命令</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1247.6.1.1%20vmstat">7.6.1.1 vmstat</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1257.6.1.1.1%20(procs)%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5">7.6.1.1.1 (procs)进程信息字段</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1267.6.1.1.2%20memory(%E5%86%85%E5%AD%98%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)">7.6.1.1.2 memory(内存信息字段)</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1277.6.1.1.3%20swap(%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF)">7.6.1.1.3 swap(交换分区信息)</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1287.6.1.1.4%20io(%E7%A3%81%E7%9B%98%E8%AF%BB%E5%86%99)">7.6.1.1.4 io(磁盘读写)</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1297.6.1.1.5%20system(%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)">7.6.1.1.5 system(系统信息字段)</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1307.6.1.1.6%20CPU(CPU%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)">7.6.1.1.6 CPU(CPU信息字段)</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1317.6.1.2%20free">7.6.1.2 free</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1327.6.1.2.1%20%E7%AC%AC%E4%B8%80%E8%A1%8C">7.6.1.2.1 第一行</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1337.6.1.2.2%20%E7%AC%AC%E4%BA%8C%E8%A1%8C">7.6.1.2.2 第二行</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1347.6.1.2.3%20%E7%AC%AC%E4%B8%89%E8%A1%8C">7.6.1.2.3 第三行</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1357.6.1.3%20%E6%9F%A5%E8%AF%A2%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81">7.6.1.3 查询网络状态</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1367.6.2%20%E5%87%BD%E6%95%B0">7.6.2 函数</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1377.6.2.1%20cpu">7.6.2.1 cpu</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1387.6.2.2%20memory">7.6.2.2 memory</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1397.6.2.3%20disk">7.6.2.3 disk</a></li></ul></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1407.7%20%E7%9B%91%E6%8E%A7%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F">7.7 监控网络流量</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1417.8%20%E7%9B%91%E6%8E%A7%E7%BD%91%E7%AB%99%E7%8A%B6%E6%80%81">7.8 监控网站状态</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1427.9%20%E7%9B%91%E6%8E%A7nginx%E7%8A%B6%E6%80%81">7.9 监控nginx状态</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1437.9.1%20%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85nginx">7.9.1 本地安装nginx</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1447.9.2%20%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC">7.9.2 监控脚本</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1457.10%20%E7%9B%91%E6%8E%A7mysql%E7%8A%B6%E6%80%81">7.10 监控mysql状态</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1467.10.1%20%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85mysql">7.10.1 本地安装mysql</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1477.10.2%20%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E5%92%8C%E5%BF%98%E8%AE%B0%E5%AF%86%E7%A0%81">7.10.2 默认密码和忘记密码</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1487.10.3%20%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC">7.10.3 监控脚本</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1497.11%20mysql%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC">7.11 mysql备份脚本</a></li></ul></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1508.%20%E9%99%84%E5%BD%95">8. 附录</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1518.1.%20%20Linux%E7%89%B9%E6%AE%8A%E6%96%87%E4%BB%B6">8.1.  Linux特殊文件</a><ul><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1528.1.1%20%E5%9D%97%E8%AE%BE%E5%A4%87">8.1.1 块设备</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1538.1.2%20%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87">8.1.2 字符设备</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1548.1.3%20%E7%AE%A1%E9%81%93%E6%96%87%E4%BB%B6">8.1.3 管道文件</a></li><li><a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1558.1.4%20%E5%A5%97%E6%8E%A5%E5%AD%97">8.1.4 套接字</a></li></ul></li></ul></li></ul>
    </div>
    
    <div class="content markdown-body">
        <h2 id="t01. shell基础">1. shell基础 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t01.%20shell%E5%9F%BA%E7%A1%80"> # </a></h2>
<ul>
<li>shell是一个命令行解释器，它为用户提供了一个向Linux内核发送请求以便运行程序的界面系统级程序</li>
<li>用户可以用Shell来启动、挂起、停止或者编写一些程序</li>
<li>Shell还是一个功能相当强大的编程语言，易编写，易调试，灵活性较强。</li>
<li>Shell是解释执行的脚本语言，在Shell中可以直接调用Linux系统命令。</li>
</ul>
<h3 id="t11.1 查看支持的shell">1.1 查看支持的shell <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t11.1%20%E6%9F%A5%E7%9C%8B%E6%94%AF%E6%8C%81%E7%9A%84shell"> # </a></h3>
<ul>
<li><code>cat /etc/shells</code></li>
</ul>
<p>查看shell的帮助信息</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">man bash</td>
<td style="text-align:left">查看bash的命令帮助</td>
</tr>
<tr>
<td style="text-align:left">info bash</td>
<td style="text-align:left">查看bash的文档</td>
</tr>
<tr>
<td style="text-align:left">help</td>
<td style="text-align:left">命令显示bash支持的命令</td>
</tr>
<tr>
<td style="text-align:left">help cd</td>
<td style="text-align:left">如果想看某个命令的帮助可以 <code>help</code> 命令</td>
</tr>
</tbody>
</table>
<h3 id="t21.2 echo">1.2 echo <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t21.2%20echo"> # </a></h3>
<ul>
<li>输出命令</li>
<li>--e 支持反斜线控制的字符转换</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">控制字符</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">\n</td>
<td style="text-align:left">换行符</td>
</tr>
<tr>
<td style="text-align:left">\r</td>
<td style="text-align:left">回车键</td>
</tr>
<tr>
<td style="text-align:left">\t</td>
<td style="text-align:left">制表符，也就是Tab键</td>
</tr>
<tr>
<td style="text-align:left">\v</td>
<td style="text-align:left">垂直制表符</td>
</tr>
<tr>
<td style="text-align:left">\onnn</td>
<td style="text-align:left">按照八进制ASCII码表输出字符，其中0为数字零，nnn是三位八进制数</td>
</tr>
<tr>
<td style="text-align:left">\xhh</td>
<td style="text-align:left">按照十六进制ASCII码表输出字符，其中hh是两位十六进制数</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">符号</th>
<th style="text-align:left">颜色</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">#30m</td>
<td style="text-align:left">黑色</td>
</tr>
<tr>
<td style="text-align:left">#31</td>
<td style="text-align:left">红色</td>
</tr>
<tr>
<td style="text-align:left">#32</td>
<td style="text-align:left">绿色</td>
</tr>
<tr>
<td style="text-align:left">#33</td>
<td style="text-align:left">黄色</td>
</tr>
<tr>
<td style="text-align:left">#34</td>
<td style="text-align:left">蓝色</td>
</tr>
<tr>
<td style="text-align:left">#35</td>
<td style="text-align:left">洋红</td>
</tr>
<tr>
<td style="text-align:left">#36</td>
<td style="text-align:left">青涩</td>
</tr>
<tr>
<td style="text-align:left">#37</td>
<td style="text-align:left">白色</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">echo -e <span class="hljs-string">"12\r\n34\t56\v78"</span>
echo -e <span class="hljs-string">"\0141"</span>
echo -e <span class="hljs-string">"\x61"</span>
echo -e <span class="hljs-string">"\e[1;31m warning \e[0m"</span>
</code></pre>
<h3 id="t31.3 编写执行shell">1.3 编写执行shell <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t31.3%20%E7%BC%96%E5%86%99%E6%89%A7%E8%A1%8Cshell"> # </a></h3>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;34m hello world \e[0m"</span>
</code></pre>
<p>赋予执行权限，直接运行</p>
<pre><code class="lang-sh">chmod 755 hello.sh
./hello.sh
</code></pre>
<p>通过Bash调用执行脚本</p>
<pre><code class="lang-sh">bash hello.sh
</code></pre>
<h3 id="t41.4 别名">1.4 别名 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t41.4%20%E5%88%AB%E5%90%8D"> # </a></h3>
<ul>
<li>命令别名 == 小名</li>
<li>临时生效</li>
<li>alias</li>
<li>alias rm="rm -i"</li>
<li>写入环境变量配置文件 vi ~/.bashrc </li>
<li>source ~/.bashrc</li>
<li>unalias 别名 删除别名</li>
</ul>
<h3 id="t51.5 命令的生效顺序">1.5 命令的生效顺序 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t51.5%20%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%9F%E6%95%88%E9%A1%BA%E5%BA%8F"> # </a></h3>
<ul>
<li>绝对路径或者相对路径</li>
<li>别名</li>
<li>bash内部命令</li>
<li>按照$PATH环境变量定义的目录查找顺序找到的第一个命令</li>
</ul>
<h3 id="t61.6 命令快捷键">1.6 命令快捷键 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t61.6%20%E5%91%BD%E4%BB%A4%E5%BF%AB%E6%8D%B7%E9%94%AE"> # </a></h3>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ctrl+c</td>
<td style="text-align:left">强制终止当前命令</td>
</tr>
<tr>
<td style="text-align:left">ctrl+l</td>
<td style="text-align:left">清屏</td>
</tr>
<tr>
<td style="text-align:left">ctrl+a</td>
<td style="text-align:left">光标移动到命令行首</td>
</tr>
<tr>
<td style="text-align:left">ctrl+e</td>
<td style="text-align:left">光标移动到命令行尾</td>
</tr>
<tr>
<td style="text-align:left">ctrl+u</td>
<td style="text-align:left">从光标所在的位置删除到行首</td>
</tr>
<tr>
<td style="text-align:left">ctrl+z</td>
<td style="text-align:left">把命令放入后台</td>
</tr>
<tr>
<td style="text-align:left">fg</td>
<td style="text-align:left">把任务带回前台</td>
</tr>
<tr>
<td style="text-align:left">ctrl+r</td>
<td style="text-align:left">在历史命令中搜索</td>
</tr>
</tbody>
</table>
<h3 id="t71.7 历史命令">1.7 历史命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t71.7%20%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4"> # </a></h3>
<ul>
<li>history [选项] [历史命令保存文件]</li>
<li>选项<ul>
<li>-c 清空历史命令</li>
<li>-w 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history</li>
</ul>
</li>
<li>默认保存1000条   /etc/profile <code>HISSIZE=10000</code></li>
</ul>
<h3 id="t81.8 调用">1.8 调用 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t81.8%20%E8%B0%83%E7%94%A8"> # </a></h3>
<ul>
<li>使用上下箭头调用以前的历史命令</li>
<li>使用 !n 重复执行第n条历史命令</li>
<li>使用 !! 重复执行上一条命令</li>
<li>使用  !字符  重复执行最后一条以该字符串开头的命令</li>
</ul>
<pre><code class="lang-js">history -c
<span class="hljs-number">1</span>  echo <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  echo <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  echo <span class="hljs-number">3</span>
!<span class="hljs-number">2</span>
!!
!echo
</code></pre>
<h3 id="t91.9 输出重定向">1.9 输出重定向 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t91.9%20%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"> # </a></h3>
<h4 id="t101.9.1 标准输入输出">1.9.1 标准输入输出 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t101.9.1%20%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">设备</th>
<th style="text-align:left">设备文件名</th>
<th style="text-align:left">文件描述符</th>
<th style="text-align:left">类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">键盘</td>
<td style="text-align:left">/dev/stdin</td>
<td style="text-align:left">0</td>
<td style="text-align:left">标准输入</td>
</tr>
<tr>
<td style="text-align:left">显示器</td>
<td style="text-align:left">/dev/stdout</td>
<td style="text-align:left">1</td>
<td style="text-align:left">标准输出</td>
</tr>
<tr>
<td style="text-align:left">显示器</td>
<td style="text-align:left">/dev/stderr</td>
<td style="text-align:left">2</td>
<td style="text-align:left">标准错误输出</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">符号</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">标准输出重定向</td>
<td style="text-align:left">命令 &gt; 文件</td>
<td style="text-align:left">以覆盖的方式，把命令的正确输出输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">标准输出重定向</td>
<td style="text-align:left">命令 &gt;&gt; 文件</td>
<td style="text-align:left">以追加的方式，把命令的正确输出输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">错误输出重定向</td>
<td style="text-align:left">命令&gt;文件</td>
<td style="text-align:left">以覆盖的方式，把命令的错误输出输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">错误输出重定向</td>
<td style="text-align:left">命令&gt;&gt;文件</td>
<td style="text-align:left">以追加的方式，把命令的错误输出输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">正确输出和错误输出同时保存</td>
<td style="text-align:left">命令&gt;文件 2&gt;&amp;1</td>
<td style="text-align:left">以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td>
</tr>
<tr>
<td style="text-align:left">正确输出和错误输出同时保存</td>
<td style="text-align:left">命令&gt;文件 2&gt;&gt;&amp;1</td>
<td style="text-align:left">以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td>
</tr>
<tr>
<td style="text-align:left">正确输出和错误输出同时保存</td>
<td style="text-align:left">命令&amp;&gt;文件</td>
<td style="text-align:left">以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td>
</tr>
<tr>
<td style="text-align:left">正确输出和错误输出同时保存</td>
<td style="text-align:left">命令&amp;&gt;&gt;文件</td>
<td style="text-align:left">以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td>
</tr>
<tr>
<td style="text-align:left">正确输出和错误输出同时保存</td>
<td style="text-align:left">命令&gt;&gt;文件1 2&gt;文件2</td>
<td style="text-align:left">以覆盖的方式，正确的输出追加到文件1中，把错误输出追加到文件2中</td>
</tr>
</tbody>
</table>
<h4 id="t111.9.2 输入重定向">1.9.2 输入重定向 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t111.9.2%20%E8%BE%93%E5%85%A5%E9%87%8D%E5%AE%9A%E5%90%91"> # </a></h4>
<ul>
<li><code>wc</code>命令的功能为统计指定文件中的行数、字数、字节数, 并将统计结果显示输出</li>
<li>命令 &lt; 文件把文件做为命令的输入</li>
<li>命令 &lt;&lt; 标识符
标识符把标识符之间内容作为命令的输入</li>
</ul>
<pre><code class="lang-js">- wc &lt; access.log 
[root@localhost ~]# wc &lt;&lt;!
&gt; hello world
&gt; !
 1  2 12
</code></pre>
<h3 id="t121.10 管道符号">1.10 管道符号 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t121.10%20%E7%AE%A1%E9%81%93%E7%AC%A6%E5%8F%B7"> # </a></h3>
<h4 id="t131.10.1 多命令顺序执行">1.10.1 多命令顺序执行 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t131.10.1%20%E5%A4%9A%E5%91%BD%E4%BB%A4%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">多命令执行符</th>
<th style="text-align:left">格式</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">案例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">;</td>
<td style="text-align:left">命令1;命令2</td>
<td style="text-align:left">多个命令执行，命令之间没有任何逻辑联系</td>
<td style="text-align:left">echo 1;echo 2;</td>
</tr>
<tr>
<td style="text-align:left">&amp;&amp;</td>
<td style="text-align:left">命令1&amp;&amp;命令2</td>
<td style="text-align:left">逻辑与   当命令1正确执行，则命令2才会执行  当命令1执行不正确，则命令2不会执行</td>
<td style="text-align:left">echo 1&amp;&amp;echo 2;</td>
</tr>
<tr>
<td style="text-align:left">\\</td>
<td style="text-align:left">命令1\\ 命令2</td>
<td style="text-align:left">逻辑或 当命令1执行不正确，则命令2才会执行 当命令1正确执行，则命令2不会执行</td>
<td style="text-align:left">echo 1\\echo 2;</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sh">- date;ls;date;ls
- ls &amp;&amp; <span class="hljs-built_in">echo</span> yes || <span class="hljs-built_in">echo</span> no
</code></pre>
<h4 id="t141.10.2 管道符号">1.10.2 管道符号 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t141.10.2%20%E7%AE%A1%E9%81%93%E7%AC%A6%E5%8F%B7"> # </a></h4>
<ul>
<li>命令1的正确输出会作为命令2的操作对象</li>
<li>命令1|命令2<pre><code class="lang-sh">ls /etc/ | more
netstat -an | grep ESTABLISHED | wc -l
</code></pre>
</li>
</ul>
<h4 id="t151.10.3 通配符">1.10.3 通配符 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t151.10.3%20%E9%80%9A%E9%85%8D%E7%AC%A6"> # </a></h4>
<p>匹配文件名和目录名</p>
<table>
<thead>
<tr>
<th style="text-align:left">通配符</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">?</td>
<td style="text-align:left">匹配一个任意字符</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">匹配0个或任意字符，也就是可以匹配任意内容</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">匹配中括号中任意一个字符</td>
</tr>
<tr>
<td style="text-align:left">[-]</td>
<td style="text-align:left">匹配中括号中任意一个字符,-代表范围</td>
</tr>
<tr>
<td style="text-align:left">[^]</td>
<td style="text-align:left">匹配不是中括号中的一个字符</td>
</tr>
</tbody>
</table>
<h4 id="t161.10.4 其它符号">1.10.4 其它符号 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t161.10.4%20%E5%85%B6%E5%AE%83%E7%AC%A6%E5%8F%B7"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">符号</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">''</td>
<td style="text-align:left">单引号。在单引号中所有的特殊符号，如$和`都没有特殊含义</td>
</tr>
<tr>
<td style="text-align:left">""</td>
<td style="text-align:left">双引号，在双引号里特殊符号都没有特殊含义，但是 $ ` \ 例外，拥有调用变量值，引用命令和转义的含义</td>
</tr>
<tr>
<td style="text-align:left"><code></code></td>
<td style="text-align:left">反引号，扩起来的是系统命令</td>
</tr>
<tr>
<td style="text-align:left">$()</td>
<td style="text-align:left">和反引号一样</td>
</tr>
<tr>
<td style="text-align:left">#</td>
<td style="text-align:left">在shell脚本中，#开头的行代表注释</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">用于调用变量的值</td>
</tr>
<tr>
<td style="text-align:left">\</td>
<td style="text-align:left">转义符号</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sh">-  a=`ls`
-  b=$(ls)
</code></pre>
<h2 id="t172. 变量">2. 变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t172.%20%E5%8F%98%E9%87%8F"> # </a></h2>
<h3 id="t182.1 什么是变量">2.1 什么是变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t182.1%20%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%98%E9%87%8F"> # </a></h3>
<ul>
<li>可以变化的量</li>
<li>变量必须以字母或下划线开头，名字中间只能由字母，数字和下划线组成</li>
<li>变量名的长度不得超过255个字符</li>
<li>变量名在有效范围内必须唯一</li>
<li>变量默认类型都是字符串</li>
</ul>
<h3 id="t192.2 变量的分类">2.2 变量的分类 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t192.2%20%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%86%E7%B1%BB"> # </a></h3>
<ul>
<li>字符串</li>
<li>整型</li>
<li>浮点型</li>
<li>日期型</li>
</ul>
<h3 id="t202.3 用户自定义变量">2.3 用户自定义变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t202.3%20%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"> # </a></h3>
<ul>
<li>这些变量的值是自己定义的</li>
<li>变量名不能为数字开头</li>
<li>等号左右两边不能有空格</li>
</ul>
<h4 id="t212.3.1 定义变量">2.3.1 定义变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t212.3.1%20%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"> # </a></h4>
<pre><code class="lang-js">name=<span class="hljs-string">"zhufeng"</span>
age=<span class="hljs-number">10</span>
</code></pre>
<h4 id="t222.3.2 输出变量值">2.3.2 输出变量值 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t222.3.2%20%E8%BE%93%E5%87%BA%E5%8F%98%E9%87%8F%E5%80%BC"> # </a></h4>
<pre><code class="lang-js">echo $变量名
</code></pre>
<h4 id="t232.3.3 值默认都是字符串">2.3.3 值默认都是字符串 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t232.3.3%20%E5%80%BC%E9%BB%98%E8%AE%A4%E9%83%BD%E6%98%AF%E5%AD%97%E7%AC%A6%E4%B8%B2"> # </a></h4>
<pre><code class="lang-js">$ x=<span class="hljs-number">1</span>
$ y=<span class="hljs-number">2</span>
$ z=<span class="hljs-number">3</span>
$ z=$x+$y+$z
$ echo $z
</code></pre>
<h4 id="t242.3.4 在赋值的时候引用变量">2.3.4 在赋值的时候引用变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t242.3.4%20%E5%9C%A8%E8%B5%8B%E5%80%BC%E7%9A%84%E6%97%B6%E5%80%99%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F"> # </a></h4>
<pre><code class="lang-js">y=<span class="hljs-string">"$y"</span><span class="hljs-number">2</span>
y=${y}<span class="hljs-number">2</span>
</code></pre>
<h4 id="t252.3.5 set">2.3.5 set <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t252.3.5%20set"> # </a></h4>
<ul>
<li>查询系统中默认所有已经生效的变量，包括系统变量,也包括自定义变量</li>
</ul>
<pre><code class="lang-js">set | grep zhufeng
</code></pre>
<pre><code class="lang-js">$ set -u
$ echo $a
bash: a: unbound variable
<span class="hljs-string">`
</span></code></pre>
<h4 id="t262.3.6 unset">2.3.6 unset <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t262.3.6%20unset"> # </a></h4>
<ul>
<li>删除变量</li>
</ul>
<pre><code class="lang-js">unset a
</code></pre>
<h3 id="t272.4 环境变量">2.4 环境变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t272.4%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> # </a></h3>
<ul>
<li>环境变量是全局变量，而自定义变量是局部变量</li>
<li>自定义变量会在当前的shell中生效，而环境变量会在当前shell以及其子shell中生效</li>
<li>这种变量主要保存的是和系统操作环境相关的数据</li>
<li>变量可以自定义，但是对系统生效的环境变量名和变量作用是固定的</li>
</ul>
<pre><code class="lang-js">bash 
pstree
</code></pre>
<h4 id="t282.4.1 自定义环境变量">2.4.1 自定义环境变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t282.4.1%20%E8%87%AA%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> 变量名=变量值
<span class="hljs-keyword">export</span> envname=prod
</code></pre>
<h4 id="t292.4.2 env">2.4.2 env <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t292.4.2%20env"> # </a></h4>
<ul>
<li>仅仅用来查看环境变量，而不看到本地变量<pre><code class="lang-js">env
</code></pre>
</li>
</ul>
<h4 id="t302.4.3 常用环境变量">2.4.3 常用环境变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t302.4.3%20%E5%B8%B8%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">变量名</th>
<th style="text-align:left">含义</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">HOSTNAME</td>
<td style="text-align:left">主机名</td>
<td style="text-align:left">HOSTNAME=localhost</td>
</tr>
<tr>
<td style="text-align:left">SHELL</td>
<td style="text-align:left">当前的shell</td>
<td style="text-align:left">SHELL=/bin/bash</td>
</tr>
<tr>
<td style="text-align:left">TERM</td>
<td style="text-align:left">终端环境</td>
<td style="text-align:left">TERM=xterm</td>
</tr>
<tr>
<td style="text-align:left">HISTSIZE</td>
<td style="text-align:left">历史命令条数</td>
<td style="text-align:left">HISTSIZE=1000</td>
</tr>
<tr>
<td style="text-align:left">SSH_CLIENT</td>
<td style="text-align:left">当前操作环境如果是用SSH连接的话，这里会记录客户端IP</td>
<td style="text-align:left">SSH_CLIENT=192.168.1.100 57596 22</td>
</tr>
<tr>
<td style="text-align:left">SSH_TTY</td>
<td style="text-align:left">SSH连接的终端</td>
<td style="text-align:left">SSH_TTY=/dev/pts/1</td>
</tr>
<tr>
<td style="text-align:left">USER</td>
<td style="text-align:left">当前登录的用户</td>
<td style="text-align:left">USER=root</td>
</tr>
</tbody>
</table>
<h4 id="t312.4.4 path">2.4.4 path <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t312.4.4%20path"> # </a></h4>
<ul>
<li>系统搜索路径</li>
</ul>
<pre><code class="lang-js"># echo $PATH
/usr/lib/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
</code></pre>
<p>如果想把一个自定义的脚本直接可以执行，或者把这个文件拷贝到目标目录下，或者把脚本所在目录添加到环境变量中的PATH路径中</p>
<p>hello.sh</p>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
echo hello
</code></pre>
<pre><code class="lang-js">./hello.sh
/root/myshell/hello.sh
<span class="hljs-keyword">export</span> PATH=<span class="hljs-string">"$PATH"</span>:<span class="hljs-regexp">/root/my</span>shell   临时生效
hello.sh
</code></pre>
<h4 id="t322.4.5 $PS1">2.4.5 $PS1 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t322.4.5%20$PS1"> # </a></h4>
<pre><code class="lang-js"># echo $PS1
[\u@\h \W]\$
root@localhost myshell]#
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">变量</th>
<th style="text-align:left">提示符</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">\d</td>
<td style="text-align:left">显示日期，格式为"星期 月 日"</td>
</tr>
<tr>
<td style="text-align:left">\H</td>
<td style="text-align:left">完整的主机名</td>
</tr>
<tr>
<td style="text-align:left">\t</td>
<td style="text-align:left">24小时制时间,格式为 "HH:MM:SS"</td>
</tr>
<tr>
<td style="text-align:left">\A</td>
<td style="text-align:left">24小时制时间，格式为 "HH:MM"</td>
</tr>
<tr>
<td style="text-align:left">\u</td>
<td style="text-align:left">显示当前用户名</td>
</tr>
<tr>
<td style="text-align:left">\w</td>
<td style="text-align:left">显示所在目录完整名称</td>
</tr>
<tr>
<td style="text-align:left">\W</td>
<td style="text-align:left">显示所在目录的最后一个目录</td>
</tr>
<tr>
<td style="text-align:left">\$</td>
<td style="text-align:left">提示符，root为#,普通用户为$</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> PS1=<span class="hljs-string">'[\u@\h \w]\$ '</span>
</code></pre>
<h4 id="t332.4.6 语系环境变量">2.4.6 语系环境变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t332.4.6%20%E8%AF%AD%E7%B3%BB%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> # </a></h4>
<ul>
<li>查询当前系统语系</li>
<li>在Linux中通过locale来设置程序运行的不同语言环境，locale由ANSI C提供支持。locale的命名规则为&lt;语言&gt;_&lt;地区&gt;.&lt;字符集编码&gt;，如zh_CN.UTF-8，zh代表中文，CN代表大陆地区，UTF-8表示字符集。</li>
<li>LANG: 定义系统主语系的变量</li>
</ul>
<pre><code class="lang-js">locale
LANG=zh_CN.UTF<span class="hljs-number">-8</span>

echo $LANG

下次开机之后我们系统环境
cat /etc/sysconfig/i18n
</code></pre>
<h4 id="t342.4.7 中文支持">2.4.7 中文支持 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t342.4.7%20%E4%B8%AD%E6%96%87%E6%94%AF%E6%8C%81"> # </a></h4>
<ul>
<li>图形界面可以支持中文</li>
<li>第三方工具比如xshell语系设置正确可以支持中文</li>
<li>虚拟机中的纯字符界面不支持中文</li>
</ul>
<h3 id="t352.5 位置参数变量">2.5 位置参数变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t352.5%20%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%98%E9%87%8F"> # </a></h3>
<ul>
<li>这种变量主要是用来向脚本当中传递参数或数据的,变量名不能自定义,变量作用是固定的</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">位置参数变量</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$n</td>
<td style="text-align:left">n为数字，$0代表命令本身，$1-$9代表第1到第9个参数，10以上的参数需要用大括号包含,如${10}</td>
</tr>
<tr>
<td style="text-align:left">$*</td>
<td style="text-align:left">这个变量代表命令中所有的参数，$*把所有的变看数看成一个整体</td>
</tr>
<tr>
<td style="text-align:left">$@</td>
<td style="text-align:left">这个变量也代表命令行中所有的参数，不过$@把每个参数进行区分</td>
</tr>
<tr>
<td style="text-align:left">$#</td>
<td style="text-align:left">这个变量代表命令行中所有参数的个数</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
num1=$<span class="hljs-number">1</span>
num2=$<span class="hljs-number">2</span>
sum=$((num1+num2))
echo $sum
</code></pre>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">"$@"</span>
 <span class="hljs-keyword">do</span>
   echo <span class="hljs-string">"i=$i"</span>
 done
</code></pre>
<h3 id="t362.6 预定义变量">2.6 预定义变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t362.6%20%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"> # </a></h3>
<ul>
<li>是脚本中已经定义好的变量，变量名不能自定义，变量作用也是固定的</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">位置参数变量</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$?</td>
<td style="text-align:left">最后一次执行的命令的返回状态。0表示正确执行，非0表示不正确执行</td>
</tr>
<tr>
<td style="text-align:left">$$</td>
<td style="text-align:left">当前进程的进程号(PID)</td>
</tr>
<tr>
<td style="text-align:left">$!</td>
<td style="text-align:left">后台运行的最后一个进程号(PID)</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">ls &amp;&amp; echo yes
</code></pre>
<h3 id="t372.7 read">2.7 read <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t372.7%20read"> # </a></h3>
<p>read [选项] [变量名]</p>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">提示信息，在等待read输入时，输出提示信息</td>
</tr>
<tr>
<td style="text-align:left">-t</td>
<td style="text-align:left">秒数: read命令会一直等待用户输入，使用此选项可以指定等待时间</td>
</tr>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">字符数，read命令只接受指定的字符数，就会执行</td>
</tr>
<tr>
<td style="text-align:left">-s</td>
<td style="text-align:left">隐藏输入的数据，适用于机密信息的输入</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
read -p <span class="hljs-string">'please input your name:'</span> -t <span class="hljs-number">5</span> name
echo -e <span class="hljs-string">"\n"</span>
read -p <span class="hljs-string">'please input you gender[m/f]:'</span> -n <span class="hljs-number">1</span> gender
echo -e <span class="hljs-string">"\n"</span>
read -p <span class="hljs-string">'please input your password:'</span> -s password
echo -e <span class="hljs-string">"\n"</span>
echo $name,$gender,$password
</code></pre>
<h2 id="t383. 运算符">3. 运算符 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t383.%20%E8%BF%90%E7%AE%97%E7%AC%A6"> # </a></h2>
<ul>
<li>弱类型并且默认是字符串类型</li>
</ul>
<h3 id="t393.1 declare命令">3.1 declare命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t393.1%20declare%E5%91%BD%E4%BB%A4"> # </a></h3>
<h4 id="t403.1.1 declare命令">3.1.1 declare命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t403.1.1%20declare%E5%91%BD%E4%BB%A4"> # </a></h4>
<ul>
<li>用来声明变量类型</li>
<li>declare [+/-] [选项] 变量名</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">给变量设定类型属性</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">取消变量的类型属性</td>
</tr>
<tr>
<td style="text-align:left">-a</td>
<td style="text-align:left">将变量声明为数组类型</td>
</tr>
<tr>
<td style="text-align:left">-i</td>
<td style="text-align:left">将变量声明为整数型(integer)</td>
</tr>
<tr>
<td style="text-align:left">-x</td>
<td style="text-align:left">将变量声明为环境变量</td>
</tr>
<tr>
<td style="text-align:left">-r</td>
<td style="text-align:left">将变量声明为只读变量</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">显示指定变量的被声明的类型</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">//声明成整型
# a=1
# b=2
# c=$a+$b
# echo $c
1+2
# declare -i c=$a+$b
# echo $c
3
# declare +i c
# c=$a+$b
# echo $c
1+2
# declare -p c
declare -i c="3"

//声明环境变量
# declare -x kk=1
# bash
# set | grep kk

//只读
# declare -r x
# x=2
</code></pre>
<h4 id="t413.1.2 数组">3.1.2 数组 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t413.1.2%20%E6%95%B0%E7%BB%84"> # </a></h4>
<pre><code class="lang-js">names[0]=zhangsan
names[1]=lisi
# 声明为数组类型
declare -a names;
# 默认只打印第一个元素
echo ${names}
zhangsan
打印第2个元素
# echo ${names[1]}
lisi
# 打印全部
echo ${names[*]}
zhangsan lisi
</code></pre>
<h4 id="t423.1.3 声明环境变量">3.1.3 声明环境变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t423.1.3%20%E5%A3%B0%E6%98%8E%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> # </a></h4>
<ul>
<li>export最终执行的是<code>declare -x</code>命令</li>
<li><code>declare -p</code> 可以查看所有的类型</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> NAME=zhufeng
declare -x NAME=zhufeng
</code></pre>
<h4 id="t433.1.4 只读属性">3.1.4 只读属性 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t433.1.4%20%E5%8F%AA%E8%AF%BB%E5%B1%9E%E6%80%A7"> # </a></h4>
<pre><code class="lang-js">#declare -r gender=m
#gender=f
-bash: gender: readonly variable
</code></pre>
<h4 id="t443.1.5 查询变量属性">3.1.5 查询变量属性 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t443.1.5%20%E6%9F%A5%E8%AF%A2%E5%8F%98%E9%87%8F%E5%B1%9E%E6%80%A7"> # </a></h4>
<ul>
<li>declare -p 查询所有变量的属性</li>
<li>declare -p 变量名 查询指定变量的属性</li>
</ul>
<h3 id="t453.2 数值运算的方法">3.2 数值运算的方法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t453.2%20%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97%E7%9A%84%E6%96%B9%E6%B3%95"> # </a></h3>
<ul>
<li>只要用declare声明变量的时候指定类型就可以进行数值运算<h4 id="t463.2.1 expr或let">3.2.1 expr或let <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t463.2.1%20expr%E6%88%96let"> # </a></h4>
</li>
<li><ul>
<li>号左右两侧必须有空格,否则还是整块输出</li>
</ul>
</li>
</ul>
<pre><code class="lang-js">#num1=2
#num2=3
#s=$(expr $num1 + $num2)
#echo $s
5
</code></pre>
<pre><code class="lang-js">#s=$(($num1+$num2))
#echo $s
5
#s=$[$num1+$num2]
#echo $s
5

d=$(date)
echo $d
</code></pre>
<h4 id="t473.2.2 优先级">3.2.2 优先级 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t473.2.2%20%E4%BC%98%E5%85%88%E7%BA%A7"> # </a></h4>
<p><img src="./61.5.devops-shell_files/priority.png" alt="priority"></p>
<pre><code class="lang-js">result=$(((<span class="hljs-number">1</span>+<span class="hljs-number">2</span>)*<span class="hljs-number">4</span>/<span class="hljs-number">2</span>))
<span class="hljs-number">6</span>
<span class="hljs-string">`
</span></code></pre>
<h2 id="t484. 环境变量配置文件">4. 环境变量配置文件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t484.%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"> # </a></h2>
<h3 id="t494.1  source 命令">4.1  source 命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t494.1%20%20source%20%E5%91%BD%E4%BB%A4"> # </a></h3>
<ul>
<li>修改完配置文件后，必须注销重新登录才能生效，使用source命令可以不用重新登录 </li>
<li>source 配置文件</li>
<li><code>. 配置文件</code></li>
</ul>
<h3 id="t504.2 环境变量配置文件简介">4.2 环境变量配置文件简介 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t504.2%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%80%E4%BB%8B"> # </a></h3>
<ul>
<li>PATH、HISTSIZE、PS1、HOSTNAME等环境变量写入对应的环境变量配置文件</li>
<li>环境变量配置文件中主要是定义地系统操作环境生效的系统默认环境变量，如PATH等
此下文件登录时起作用的环境变量</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">路径</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/etc/profile</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">/etc/profile.d/*.sh</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">/etc/bashrc</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">~/.bash_profile</td>
<td style="text-align:left">只会对当前用户生效</td>
</tr>
<tr>
<td style="text-align:left">~/.bashrc</td>
<td style="text-align:left">只会对当前用户生效</td>
</tr>
</tbody>
</table>
<p><img src="./61.5.devops-shell_files/loadenv.jpg" alt="loadenv"></p>
<h3 id="t514.3 环境变量配置文件的功能">4.3 环境变量配置文件的功能 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t514.3%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%8A%9F%E8%83%BD"> # </a></h3>
<h4 id="t524.3.1 /etc/profile">4.3.1 /etc/profile <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t524.3.1%20/etc/profile"> # </a></h4>
<ul>
<li>在这里修改系统变量</li>
</ul>
<pre><code class="lang-js">cat  /etc/profile | grep USER
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">变量名</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">USER</td>
<td style="text-align:left">用户名</td>
</tr>
<tr>
<td style="text-align:left">LOGNAME</td>
<td style="text-align:left">登录名</td>
</tr>
<tr>
<td style="text-align:left">MAIL</td>
<td style="text-align:left">邮箱地址</td>
</tr>
<tr>
<td style="text-align:left">PATH</td>
<td style="text-align:left">查找路径</td>
</tr>
<tr>
<td style="text-align:left">HOSTNAE</td>
<td style="text-align:left">主机名</td>
</tr>
<tr>
<td style="text-align:left">umask</td>
<td style="text-align:left">权限掩码</td>
</tr>
<tr>
<td style="text-align:left">/etc/profile.d/星.sh</td>
</tr>
</tbody>
</table>
<h4 id="t534.3.2 ~/.bash_profile">4.3.2 ~/.bash_profile <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t534.3.2%20~/.bash_profile"> # </a></h4>
<ul>
<li>PATH  在这里修改PATH路径</li>
<li>调用 ~/.bashrc</li>
</ul>
<h4 id="t544.3.3 ~/.bashrc">4.3.3 ~/.bashrc <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t544.3.3%20~/.bashrc"> # </a></h4>
<ul>
<li>配置alias  改别名在这里</li>
<li>调用 /etc/bashrc</li>
</ul>
<h4 id="t554.3.4 /etc/bashrc">4.3.4 /etc/bashrc <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t554.3.4%20/etc/bashrc"> # </a></h4>
<ul>
<li>PS1 登录提示符在这里修改</li>
<li>umask</li>
<li>PATH变量</li>
<li>调用 /etc/profile.d/星.sh文件</li>
</ul>
<h4 id="t564.3.5. 其它配置文件">4.3.5. 其它配置文件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t564.3.5.%20%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"> # </a></h4>
<h5 id="t574.3.5.1 注销时生效的环境变量配置文件">4.3.5.1 注销时生效的环境变量配置文件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t574.3.5.1%20%E6%B3%A8%E9%94%80%E6%97%B6%E7%94%9F%E6%95%88%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"> # </a></h5>
<p>~/.bash_logout</p>
<h5 id="t584.3.5.2  脚本历史">4.3.5.2  脚本历史 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t584.3.5.2%20%20%E8%84%9A%E6%9C%AC%E5%8E%86%E5%8F%B2"> # </a></h5>
<ul>
<li>当正确退出计算机的时候会历史记录会写入文件
~/.bash_history</li>
</ul>
<h5 id="t594.3.5.3 Shell登录信息">4.3.5.3 Shell登录信息 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t594.3.5.3%20Shell%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF"> # </a></h5>
<p>本地终端欢迎信息 /etc/issue
远程终端欢迎信息 /etc/issue.net
不管远程还是本地都可以生效 /etc/motd</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">\d</td>
<td style="text-align:left">当前系统日期</td>
</tr>
<tr>
<td style="text-align:left">\s</td>
<td style="text-align:left">显示操作系统名称</td>
</tr>
<tr>
<td style="text-align:left">\l</td>
<td style="text-align:left">显示登录的终端号</td>
</tr>
<tr>
<td style="text-align:left">\m</td>
<td style="text-align:left">显示硬件体系结构，如i386等</td>
</tr>
<tr>
<td style="text-align:left">\n</td>
<td style="text-align:left">显示主机名</td>
</tr>
<tr>
<td style="text-align:left">\o</td>
<td style="text-align:left">显示域名</td>
</tr>
<tr>
<td style="text-align:left">\r</td>
<td style="text-align:left">显示内核版本</td>
</tr>
<tr>
<td style="text-align:left">\t</td>
<td style="text-align:left">显示当前系统时间</td>
</tr>
<tr>
<td style="text-align:left">\u</td>
<td style="text-align:left">显示当前登录用户的序列号</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">vi /etc/ssh/sshd_config
Banner /etc/issue.net
service sshd restart
</code></pre>
<h2 id="t604.正则表达式">4.正则表达式 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t604.%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"> # </a></h2>
<ul>
<li><a href="https://regexper.com/">regexper</a></li>
</ul>
<h3 id="t614.1 概念">4.1 概念 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t614.1%20%E6%A6%82%E5%BF%B5"> # </a></h3>
<ul>
<li>正则表达式是用于描述字符排列和匹配模式的一种语法规则</li>
<li>它主要用于字符串的模式分割、匹配查找及替换操作</li>
</ul>
<h3 id="t624.2 通配符">4.2 通配符 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t624.2%20%E9%80%9A%E9%85%8D%E7%AC%A6"> # </a></h3>
<ul>
<li>通配符用来匹配符合条件的文件名，通配符是完全匹配。 </li>
<li>ls  find 这些命令不支持正则，只能使用通配符</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">符号</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">?</td>
<td style="text-align:left">匹配任意一个字符</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">匹配任意多个字符</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">匹配中括号中范围内的一个字符</td>
</tr>
</tbody>
</table>
<h3 id="t634.3 正则表达式">4.3 正则表达式 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t634.3%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"> # </a></h3>
<ul>
<li>正则表达式是用来在文件中匹配符合条件的字符串，是包含匹配。</li>
<li>grep awk sed 等都可以支持正则表达式</li>
</ul>
<h3 id="t644.4 元字符">4.4 元字符 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t644.4%20%E5%85%83%E5%AD%97%E7%AC%A6"> # </a></h3>
<p><code>alias grep='grep --color=auto'</code></p>
<table>
<thead>
<tr>
<th style="text-align:left">元字符</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">前一个字符匹配 0 次或任意多次</td>
<td style="text-align:left">grep 1* reg.txt</td>
</tr>
<tr>
<td style="text-align:left">.</td>
<td style="text-align:left">匹配除换行符外的任意一个字符</td>
<td style="text-align:left">grep . reg.txt</td>
</tr>
<tr>
<td style="text-align:left">^</td>
<td style="text-align:left">匹配行首。例如，^hello 会匹配以 hello 开头的行</td>
<td style="text-align:left">grep ^a reg.txt</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">匹配行尾。例如，hello&amp; 会匹配以 hello 结尾的行</td>
<td style="text-align:left">grep a$ reg.txt</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">匹配屮柄号屮指定的任意一个字符，而且只匹配一个字符。<br>例如.[aoeiu]匹配任意一个元音字母， [0-9] 匹配任意一位数字，<br>[a-z][0-9] 匹配由小写字母和一位数字构成的两位字符</td>
<td style="text-align:left">grep ab[bc]c reg.txt</td>
</tr>
<tr>
<td style="text-align:left">[^]</td>
<td style="text-align:left">匹配除中括号中的字符以外的任意一个字符。例如，[^0-9] 匹配任意一位非数字字符，<br>[^a-z] 匹配任意一位非小写字母</td>
<td style="text-align:left">grep a[^fg]c reg.txt</td>
</tr>
<tr>
<td style="text-align:left">\</td>
<td style="text-align:left">转义符，用于取消特殊符号的含义</td>
<td style="text-align:left">grep \.$ reg.txt</td>
</tr>
<tr>
<td style="text-align:left">{n}</td>
<td style="text-align:left">表示其前面的字符恰好出现 n 次。例如，[0-9]{4} 匹配4位数字，[1][3-8][0-9]{9} 匹配手机号码</td>
<td style="text-align:left">grep "a{1}" reg.txt</td>
</tr>
<tr>
<td style="text-align:left">(n,}</td>
<td style="text-align:left">表示其前面的字符出现不少于 n 次。例如，[0-9]{2,} 匹配两位及以上的数字</td>
<td style="text-align:left">grep "a{1,}" reg.txt</td>
</tr>
<tr>
<td style="text-align:left">{n,m}</td>
<td style="text-align:left">表示其前面的字符至少出现 n 次，最多出现 m 次。例如，[a-z]{6,8} 匹配 6〜8 位的小写字母</td>
<td style="text-align:left">grep "a{2,3}" reg.txt</td>
</tr>
</tbody>
</table>
<h3 id="t654.5 cut">4.5 cut <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t654.5%20cut"> # </a></h3>
<ul>
<li>cut用来提取文本中的某一部分文本</li>
<li>cut [选项] 文件名<ul>
<li>-f 列号，用来指定要提取的列</li>
<li>-d 分隔符，按照指定分隔符分割列,默认分隔符是TAB制表符</li>
</ul>
</li>
</ul>
<pre><code class="lang-js">cat /etc/passwd | grep /bin/bash | cut -f <span class="hljs-number">1</span>,<span class="hljs-number">2</span> -d :

df -h | grep /dev/sda5 | cut -f <span class="hljs-number">5</span>
</code></pre>
<h3 id="t664.6 printf">4.6 printf <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t664.6%20printf"> # </a></h3>
<ul>
<li>按规定格式输出</li>
<li>printf 输出类型 输出内容</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">%ns</td>
<td style="text-align:left">输出字符串,n是数字指代输出几个字符</td>
</tr>
<tr>
<td style="text-align:left">%ni</td>
<td style="text-align:left">输出整数,n是指输出几个数字</td>
</tr>
<tr>
<td style="text-align:left">%m.nf</td>
<td style="text-align:left">输出浮点数,m和n是数字，指代输出的整数位数和小数位数，如%6.2f代表输出6位位，2位小数，4位整数</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">printf <span class="hljs-string">"%s\t%s\t%s\t%s\t%s\t\%s\n"</span> $(df -h | grep /dev/sda5) | cut -f <span class="hljs-number">5</span>
</code></pre>
<h3 id="t674.7 awk">4.7 awk <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t674.7%20awk"> # </a></h3>
<ul>
<li>awk '条件1{动作1} 条件2{动作2}...' 文件名</li>
<li>条件(Pattern)<ul>
<li>一般使用关系表达式作为条件</li>
<li>x &gt; 10 判断变量x是否大于10</li>
<li>x &gt;=10 大于等于</li>
<li>x &lt;=10 小于等于</li>
</ul>
</li>
<li><p>动作(Action)</p>
<ul>
<li>格式化输出</li>
</ul>
</li>
<li><p>$0 整行 $1 第一列...</p>
</li>
</ul>
<pre><code class="lang-js"> df -h | grep /dev/sda5 |awk <span class="hljs-string">'{print $5}'</span>| cut -d <span class="hljs-string">'%'</span> -f <span class="hljs-number">1</span>
</code></pre>
<h4 id="t684.7.1 begin end">4.7.1 begin end <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t684.7.1%20begin%20end"> # </a></h4>
<ul>
<li>awk可以正确截取制表符和空格</li>
<li>begin 在所有的输出之前打印</li>
<li>end 在所有的输出之后打印<pre><code class="lang-js">awk <span class="hljs-string">'BEGIN{print "开始"}END{print "结束"}'</span> numbers.txt 
</code></pre>
</li>
</ul>
<h4 id="t694.7.2 FS">4.7.2 FS <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t694.7.2%20FS"> # </a></h4>
<ul>
<li>Field Separator，字段分隔符</li>
</ul>
<pre><code class="lang-js">awk <span class="hljs-string">'BEGIN{FS=":"}{print $1"\t"$2}'</span> /etc/passwd
</code></pre>
<h4 id="t704.7.3 声明变量">4.7.3 声明变量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t704.7.3%20%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F"> # </a></h4>
<pre><code class="lang-js">awk <span class="hljs-string">'BEGIN{sum=0}{sum=sum+$1}END{print sum}'</span> numbers.txt 
</code></pre>
<h4 id="t714.7.4 多条件">4.7.4 多条件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t714.7.4%20%E5%A4%9A%E6%9D%A1%E4%BB%B6"> # </a></h4>
<pre><code class="lang-js">awk <span class="hljs-string">'$2&gt;90{print $1"\t优秀"}$2&gt;80{print $2"\t良好"}'</span> score.txt
</code></pre>
<h4 id="t724.7.5 NR">4.7.5 NR <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t724.7.5%20NR"> # </a></h4>
<ul>
<li>NR,表示awk开始执行程序后所读取的数据行数</li>
</ul>
<pre><code class="lang-js">awk <span class="hljs-string">'{print NR,$0}'</span> file1 
awk <span class="hljs-string">'NR=3{print $0}'</span> file1 
</code></pre>
<h4 id="t734.7.6 OFS">4.7.6 OFS <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t734.7.6%20OFS"> # </a></h4>
<ul>
<li>OFS Out of Field Separator，输出字段分隔符</li>
</ul>
<pre><code class="lang-js">echo <span class="hljs-string">"i love you"</span> | awk <span class="hljs-string">'BEGIN{ FS=" ";OFS="-" }{ print $1,$2,$3}'</span>
</code></pre>
<h3 id="t744.8 sed命令">4.8 sed命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t744.8%20sed%E5%91%BD%E4%BB%A4"> # </a></h3>
<ul>
<li>sed是一个轻量级编辑器，主要用来对数据进行选取、替换、替换和新增操作</li>
<li>sed [选项] '[动作]' 文件名</li>
<li>所有的动作都必须用单号号括起来</li>
<li>类型类似于批量vi操作</li>
</ul>
<p>选项</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">一般sed命令会把所有的数据都输出到屏幕上，如果加入此选项则只会把处理过的行输出到屏幕上</td>
<td style="text-align:left"><code>sed -n '2p' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">-e</td>
<td style="text-align:left">允许对输入数据应用多条sed编辑命令</td>
<td style="text-align:left">sed -e 's/75/70/g;s/55/50/g' score.txt</td>
</tr>
<tr>
<td style="text-align:left">-i</td>
<td style="text-align:left">用sed的修改直接修改编辑的文件，而不是在屏幕上输出</td>
<td style="text-align:left"><code>sed -i '1i newline' score.txt</code></td>
</tr>
</tbody>
</table>
<p>动作</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">a</td>
<td style="text-align:left">追加，在每一行或者指定行下面添加一行或多行</td>
<td style="text-align:left"><code>sed  '1a newline' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">c</td>
<td style="text-align:left">行替换，用c后面的字符串替换掉原始整个数据行</td>
<td style="text-align:left"><code>sed  'c newline' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">s</td>
<td style="text-align:left">字符串替换,用一个字符串替换另外一个字符串，格式为 "行范围s/旧字符串/新字符串/g"</td>
<td style="text-align:left"><code>sed  '3s/lisi/lisisi/g' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">i</td>
<td style="text-align:left">插入，在当前行插入一行或多行</td>
<td style="text-align:left"><code>sed  '1i newline' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">d</td>
<td style="text-align:left">删除指定的行</td>
<td style="text-align:left"><code>sed  '1,2d' score.txt</code></td>
</tr>
<tr>
<td style="text-align:left">p</td>
<td style="text-align:left">打印,输出指定的行</td>
<td style="text-align:left"><code>sed -n '2p' score.txt</code></td>
</tr>
</tbody>
</table>
<h3 id="t754.9 排序命令sort">4.9 排序命令sort <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t754.9%20%E6%8E%92%E5%BA%8F%E5%91%BD%E4%BB%A4sort"> # </a></h3>
<ul>
<li>sort [选项] 文件名</li>
<li>选项</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-f</td>
<td style="text-align:left">忽略大小写</td>
<td>sort -f -t ":" -n -k 5,5 /etc/passwd</td>
</tr>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">以数值型进行排序，默认使用字符串顺序</td>
<td>sort -t ":" -n -k 3,3 /etc/passwd</td>
</tr>
<tr>
<td style="text-align:left">-r</td>
<td style="text-align:left">反向排序，默认从小到大</td>
<td>sort -r /etc/passwd</td>
</tr>
<tr>
<td style="text-align:left">-t</td>
<td style="text-align:left">指定分割符，默认分割符是制表符</td>
<td>sort -t ":" -k 3,3 /etc/passwd</td>
</tr>
<tr>
<td style="text-align:left">-k n[,m]</td>
<td style="text-align:left">按照指定的字段范围排序。从第n个字段开始，到第m个字段结束，默认是到行尾</td>
<td>sort -t ":" -k 3,3 /etc/passwd</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">sort /etc/passwd
sort -r /etc/passwd
sort -t <span class="hljs-string">":"</span> -k <span class="hljs-number">3</span>,<span class="hljs-number">3</span> /etc/passwd
</code></pre>
<h3 id="t764.10 wc">4.10 wc <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t764.10%20wc"> # </a></h3>
<ul>
<li>wc [选项] 文件名</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-l</td>
<td style="text-align:left">只统计行数</td>
</tr>
<tr>
<td style="text-align:left">-w</td>
<td style="text-align:left">只允许单词数</td>
</tr>
<tr>
<td style="text-align:left">-m</td>
<td style="text-align:left">只统计字符数</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">wc wc.txt 
</code></pre>
<h2 id="t775. 流程控制">5. 流程控制 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t775.%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"> # </a></h2>
<h3 id="t785.1 条件判断">5.1 条件判断 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t785.1%20%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"> # </a></h3>
<h4 id="t795.1.1 按照文件类型进行判断">5.1.1 按照文件类型进行判断 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t795.1.1%20%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-d</td>
<td style="text-align:left">文件是否存在并且是目录</td>
</tr>
<tr>
<td style="text-align:left">-e</td>
<td style="text-align:left">文件是否存在</td>
</tr>
<tr>
<td style="text-align:left">-f</td>
<td style="text-align:left">文件是否存在并且是普通文件</td>
</tr>
<tr>
<td style="text-align:left">-b</td>
<td style="text-align:left">文件是否存在并且是块设备文件</td>
</tr>
<tr>
<td style="text-align:left">-c</td>
<td style="text-align:left">文件是否存在并且是字符设备文件</td>
</tr>
<tr>
<td style="text-align:left">-L</td>
<td style="text-align:left">文件是否存在并且是链接文件</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">文件是否存在并且是管道文件</td>
</tr>
<tr>
<td style="text-align:left">-s</td>
<td style="text-align:left">文件是否存在并且是否为非空</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">文件是否存在并且是套接字文件</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">test -e <span class="hljs-number">1.</span>txt
[-e <span class="hljs-number">1.</span>txt]
echo $?
</code></pre>
<pre><code class="lang-js"># [ -e 1.txt ]&amp;&amp;echo "yes"|| echo "no"
yes
# [ -e 11.txt ]&amp;&amp;echo "yes"|| echo "no"
no
</code></pre>
<h4 id="t805.1.2 按照文件权限进行判断">5.1.2 按照文件权限进行判断 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t805.1.2%20%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-r</td>
<td style="text-align:left">文件是否存在，并且是否拥有读权限</td>
</tr>
<tr>
<td style="text-align:left">-w</td>
<td style="text-align:left">文件是否存在，并且是否拥有写权限</td>
</tr>
<tr>
<td style="text-align:left">-x</td>
<td style="text-align:left">文件是否存在，并且是否拥有执行权限</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">echo read  &gt; read.txt
echo write  &gt; write.txt
echo execute  &gt; execute.txt

chmod u+w write.txt 
chmod u+x execute.txt

[ -e read.txt ]&amp;&amp;echo <span class="hljs-string">"read yes"</span>|| echo <span class="hljs-string">"no"</span>
[ -e write.txt ]&amp;&amp;echo <span class="hljs-string">"write yes"</span>|| echo <span class="hljs-string">"no"</span>
[ -e execute.txt ]&amp;&amp;echo <span class="hljs-string">"execute yes"</span>|| echo <span class="hljs-string">"no"</span>
</code></pre>
<h4 id="t815.1.3 两个文件间的比较">5.1.3 两个文件间的比较 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t815.1.3%20%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E9%97%B4%E7%9A%84%E6%AF%94%E8%BE%83"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">文件1 -nt  文件2</td>
<td style="text-align:left">判断文件1的修改时间是否比文件2的新</td>
</tr>
<tr>
<td style="text-align:left">文件1 -ot  文件2</td>
<td style="text-align:left">判断文件1的修改时间是否比文件2的旧</td>
</tr>
<tr>
<td style="text-align:left">文件1 -ef  文件2</td>
<td style="text-align:left">判断文件1和文件2的inode号是否一致,可用于判断硬链接</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">[ write.txt -nt read.txt ]&amp;&amp;echo <span class="hljs-string">"write is older than read"</span>|| echo <span class="hljs-string">"no"</span>
[ read.txt -ot write.txt ]&amp;&amp;echo <span class="hljs-string">"read is older than write"</span>|| echo <span class="hljs-string">"no"</span>
ln execute.txt execute2.txt
[ execute.txt -ef execute2.txt ]&amp;&amp;echo <span class="hljs-string">"execute and execute2.txt are the same"</span>|| echo <span class="hljs-string">"no"</span>
</code></pre>
<h4 id="t825.1.4 两个整数间的比较">5.1.4 两个整数间的比较 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t825.1.4%20%E4%B8%A4%E4%B8%AA%E6%95%B4%E6%95%B0%E9%97%B4%E7%9A%84%E6%AF%94%E8%BE%83"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">整数1 -eq 整数2</td>
<td style="text-align:left">判断整数1是否和整数2相等</td>
</tr>
<tr>
<td style="text-align:left">整数1 -ne 整数2</td>
<td style="text-align:left">判断整数1是否和整数2不相等</td>
</tr>
<tr>
<td style="text-align:left">整数1 -gt 整数2</td>
<td style="text-align:left">判断整数1是否大于整数2</td>
</tr>
<tr>
<td style="text-align:left">整数1 -lt 整数2</td>
<td style="text-align:left">判断整数1是否小于整数2</td>
</tr>
<tr>
<td style="text-align:left">整数1 -ge 整数2</td>
<td style="text-align:left">判断整数1是否大于等于整数2</td>
</tr>
<tr>
<td style="text-align:left">整数1 -le 整数2</td>
<td style="text-align:left">判断整数1是否小于等于整数2</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">[ <span class="hljs-number">2</span> -eq <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2==2"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">3</span> -ne <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2!=2"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">3</span> -gt <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2&gt;2"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">1</span> -lt <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2&lt;2"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">2</span> -ge <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2&gt;=2"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">2</span> -le <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"2&lt;=2"</span>|| echo <span class="hljs-string">"no"</span>
</code></pre>
<h4 id="t835.1.5 字符串的判断">5.1.5 字符串的判断 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t835.1.5%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%88%A4%E6%96%AD"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-z 字符串</td>
<td style="text-align:left">判断字否串是否为空</td>
</tr>
<tr>
<td style="text-align:left">-n 字符中</td>
<td style="text-align:left">判断字符串是否为非空</td>
</tr>
<tr>
<td style="text-align:left">字符串1 == 字符串2</td>
<td style="text-align:left">判断字符串1是否和字符串2相等</td>
</tr>
<tr>
<td style="text-align:left">字符串1 != 字符串2</td>
<td style="text-align:left">判断字符串1是否和字符串2不相等</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">
name=zhufeng
[ -z <span class="hljs-string">"$name"</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
name2=zhufeng
[ <span class="hljs-string">"$name"</span> == <span class="hljs-string">"$name2"</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
</code></pre>
<h4 id="t845.1.6 多重条件判断">5.1.6 多重条件判断 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t845.1.6%20%E5%A4%9A%E9%87%8D%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"> # </a></h4>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">判断1 -a  判断2</td>
<td style="text-align:left">逻辑与</td>
</tr>
<tr>
<td style="text-align:left">判断1 -o  判断2</td>
<td style="text-align:left">逻辑或</td>
</tr>
<tr>
<td style="text-align:left">!判断</td>
<td style="text-align:left">逻辑非</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">[ <span class="hljs-number">2</span> -gt <span class="hljs-number">1</span> -a <span class="hljs-number">3</span> -gt <span class="hljs-number">2</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">2</span> -gt <span class="hljs-number">1</span> -a <span class="hljs-number">3</span> -gt <span class="hljs-number">4</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
[ <span class="hljs-number">2</span> -gt <span class="hljs-number">1</span> -o <span class="hljs-number">3</span> -gt <span class="hljs-number">4</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
[ ! <span class="hljs-number">3</span> -gt <span class="hljs-number">4</span> ]&amp;&amp;echo <span class="hljs-string">"yes"</span>|| echo <span class="hljs-string">"no"</span>
</code></pre>
<h3 id="t855.2 单分支if语句">5.2 单分支if语句 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t855.2%20%E5%8D%95%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5"> # </a></h3>
<ul>
<li>if语句使用<code>fi</code>结尾</li>
<li>[条件判断式]就是使用<code>test</code>命令进行判断，所以中括号和条件判断式之间必须有空格</li>
<li>then后面跟符合条件之后执行的程序，可以放在[]之后，用;分隔，也可以换行，不用;</li>
</ul>
<h4 id="t865.2.1 语法">5.2.1 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t865.2.1%20%E8%AF%AD%E6%B3%95"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">if</span> [条件判断];then
 代码体
fi
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">if</span> [条件判断]
then
 代码体
fi
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">if</span> [ <span class="hljs-number">2</span> -gt <span class="hljs-number">1</span> ];then echo bigger; fi
</code></pre>
<h4 id="t875.2.2 判断当前用户是否是root用户">5.2.2 判断当前用户是否是root用户 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t875.2.2%20%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E6%98%AFroot%E7%94%A8%E6%88%B7"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
user=$(whoami)
user=<span class="hljs-string">`whoami`</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"$user"</span> == root ]
then
echo <span class="hljs-string">"I am root"</span>
fi
</code></pre>
<h3 id="t885.3 双分支if语句">5.3 双分支if语句 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t885.3%20%E5%8F%8C%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5"> # </a></h3>
<h4 id="t895.3.1 语法">5.3.1 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t895.3.1%20%E8%AF%AD%E6%B3%95"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">if</span> [条件判断]
then
 代码体<span class="hljs-number">1</span>
<span class="hljs-keyword">else</span>
 代码体<span class="hljs-number">2</span> 
fi
</code></pre>
<h4 id="t905.3.2 判断是否目录">5.3.2 判断是否目录 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t905.3.2%20%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E7%9B%AE%E5%BD%95"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
read -t <span class="hljs-number">10</span> -p <span class="hljs-string">"please input a filename"</span> dir
<span class="hljs-keyword">if</span> [ -d <span class="hljs-string">"$dir"</span> ]
then
  echo <span class="hljs-string">"is directory"</span>
<span class="hljs-keyword">else</span> 
  echo <span class="hljs-string">"not a direcotry"</span>
fi
</code></pre>
<h3 id="t915.4 多分支if语句">5.4 多分支if语句 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t915.4%20%E5%A4%9A%E5%88%86%E6%94%AFif%E8%AF%AD%E5%8F%A5"> # </a></h3>
<h4 id="t925.4.1 语法">5.4.1 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t925.4.1%20%E8%AF%AD%E6%B3%95"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">if</span> [条件判断<span class="hljs-number">1</span>]
then
 代码体<span class="hljs-number">1</span>
elif [条件判断<span class="hljs-number">2</span>] 
 代码体<span class="hljs-number">2</span>
<span class="hljs-keyword">else</span>
 代码体<span class="hljs-number">3</span>
fi
</code></pre>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
read -p <span class="hljs-string">"please input a grade"</span> grade
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"$grade"</span> -gt <span class="hljs-number">90</span> ]
 then
  echo great
elif [ <span class="hljs-string">"$grade"</span> -gt <span class="hljs-number">80</span> ]
  then
   echo good
<span class="hljs-keyword">else</span>
   echo bad
fi
</code></pre>
<h3 id="t935.5 case 语句">5.5 case 语句 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t935.5%20case%20%E8%AF%AD%E5%8F%A5"> # </a></h3>
<ul>
<li>case 和if 都是多分支判断语句,if能判断多个条件,case只能判断一个条件<h4 id="t945.5.1 语法">5.5.1 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t945.5.1%20%E8%AF%AD%E6%B3%95"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">case</span> 变量名 <span class="hljs-keyword">in</span> 
值<span class="hljs-number">1</span>)
  代码块<span class="hljs-number">1</span>
  ;;
值<span class="hljs-number">2</span>)
  代码块<span class="hljs-number">2</span>
 ;;
*)
  代码块<span class="hljs-number">3</span>
 ;;
esac
</code></pre>
</li>
</ul>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
read -p <span class="hljs-string">"yes or no?"</span> -t <span class="hljs-number">30</span> choose
<span class="hljs-keyword">case</span> $choose <span class="hljs-keyword">in</span> 
  <span class="hljs-string">"yes"</span>)
    echo <span class="hljs-string">'yes'</span>
    ;;
  <span class="hljs-string">"no"</span>)
    echo <span class="hljs-string">"no"</span>
   ;;
  *)
    echo other
   ;;
esac
</code></pre>
<h3 id="t955.6 for循环">5.6 for循环 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t955.6%20for%E5%BE%AA%E7%8E%AF"> # </a></h3>
<h3 id="t965.6.1 语法">5.6.1 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t965.6.1%20%E8%AF%AD%E6%B3%95"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-keyword">for</span> 变量 <span class="hljs-keyword">in</span> 值<span class="hljs-number">1</span> 值<span class="hljs-number">2</span> 值<span class="hljs-number">3</span>
<span class="hljs-keyword">do</span>
代码块
done
</code></pre>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>
<span class="hljs-keyword">do</span>
 echo $i
done
</code></pre>
<h3 id="t975.6.2 语法">5.6.2 语法 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t975.6.2%20%E8%AF%AD%E6%B3%95"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash  </span>

<span class="hljs-keyword">for</span>((i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">10</span>;i++));  
<span class="hljs-keyword">do</span>   
 echo $(($i));  <span class="hljs-comment">//加不加$都一样</span>
done 
</code></pre>
<h3 id="t985.7 while循环">5.7 while循环 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t985.7%20while%E5%BE%AA%E7%8E%AF"> # </a></h3>
<ul>
<li>while循环是不定循环，也称为条件循环，只要条件判断成立，就会一直继续</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">while</span> [条件判断式]
<span class="hljs-keyword">do</span>
 代码块
done
</code></pre>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
i=<span class="hljs-number">1</span>
result=<span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> [ $i -le <span class="hljs-number">100</span> ]
 <span class="hljs-keyword">do</span>
   result=$(($result+i))
   i=$(($i+<span class="hljs-number">1</span>))
 done
echo $result
</code></pre>
<h3 id="t995.8 until循环">5.8 until循环 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t995.8%20until%E5%BE%AA%E7%8E%AF"> # </a></h3>
<ul>
<li>直到条件不成立停止</li>
</ul>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
i=<span class="hljs-number">1</span>
result=<span class="hljs-number">0</span>
until [ $i -gt <span class="hljs-number">100</span> ]
 <span class="hljs-keyword">do</span>
   result=$(($result+i))
   i=$(($i+<span class="hljs-number">1</span>))
 done
echo $result
</code></pre>
<h2 id="t1006. 函数">6. 函数 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1006.%20%E5%87%BD%E6%95%B0"> # </a></h2>
<ul>
<li>linux shell 可以用户定义函数，然后在shell脚本中可以随便调用</li>
<li>可以带function fun() 定义，也可以直接fun() 定义,不带任何参数</li>
<li>调用函数不需要加()</li>
</ul>
<h3 id="t1016.1 简单函数">6.1 简单函数 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1016.1%20%E7%AE%80%E5%8D%95%E5%87%BD%E6%95%B0"> # </a></h3>
<pre><code class="lang-js">[ function ] funcname [()]
{
    action;
    [return int;]
}
</code></pre>
<pre><code class="lang-js">start(){
&gt;  echo start
&gt; }
 start
</code></pre>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
start(){
 echo start
}
start
</code></pre>
<h3 id="t1026.2 返回值">6.2 返回值 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1026.2%20%E8%BF%94%E5%9B%9E%E5%80%BC"> # </a></h3>
<ul>
<li>参数返回，可以显示加：return 返回，如果不加，将以最后一条命令运行结果，作为返回值</li>
</ul>
<pre><code class="lang-js">&gt; sum4(){
&gt; r=$(($1+$2))
&gt; return $r
&gt; }
# sum4 2 3
echo $?
5
</code></pre>
<h3 id="t1036.3 参数说明">6.3 参数说明 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1036.3%20%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"> # </a></h3>
<table>
<thead>
<tr>
<th style="text-align:left">参数处理</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$#</td>
<td style="text-align:left">传递到脚本的参数个数</td>
</tr>
<tr>
<td style="text-align:left">$*</td>
<td style="text-align:left">以一个单字符串显示所有向脚本传递的参数</td>
</tr>
<tr>
<td style="text-align:left">$@</td>
<td style="text-align:left">与$*相同，但是使用时加引号，并在引号中返回每个参数</td>
</tr>
<tr>
<td style="text-align:left">$$</td>
<td style="text-align:left">脚本运行的当前进程ID号</td>
</tr>
<tr>
<td style="text-align:left">$!</td>
<td style="text-align:left">后台运行的最后一个进程的ID号</td>
</tr>
<tr>
<td style="text-align:left">$-</td>
<td style="text-align:left">显示Shell使用的当前选项，与set命令功能相同</td>
</tr>
<tr>
<td style="text-align:left">$?</td>
<td style="text-align:left">显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误</td>
</tr>
</tbody>
</table>
<h3 id="t1046.4 profile">6.4 profile <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1046.4%20profile"> # </a></h3>
<ul>
<li><a href="http://tldp.org/LDP/abs/html/parameter-substitution.html">parameter-substitution</a></li>
<li><p><a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02">shell帮助文档</a></p>
<pre><code class="lang-js">echo $-
echo <span class="hljs-string">"${-#*i}"</span>
</code></pre>
<h4 id="t1056.4.1 脚本">6.4.1 脚本 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1056.4.1%20%E8%84%9A%E6%9C%AC"> # </a></h4>
<p>cat /etc/profile</p>
<pre><code class="lang-js"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> /etc/profile.d<span class="hljs-comment">/*.sh ; do
  if [ -r "$i" ]; then
      if [ "${-#*i}" != "$-" ]; then
          . "$i"
      else
          . "$i" &gt;/dev/null 2&gt;&amp;1
      fi
  fi
done
</span></code></pre>
</li>
<li><p>如果现在执行的命令(或脚本)是交互式（interactively），那么加载之</p>
</li>
<li>如果执行的命令（或脚本）是非交互式（non-interactively），那么加载之，并且将输出重定向到 /dev/null,目的是防止有些执行某些程序（如scp），需要登录到远端机器，读取远端机器的环境变量有输出，导致程序中断！</li>
</ul>
<h4 id="t1066.4.2 打印当前shell的选项">6.4.2 打印当前shell的选项 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1066.4.2%20%E6%89%93%E5%8D%B0%E5%BD%93%E5%89%8Dshell%E7%9A%84%E9%80%89%E9%A1%B9"> # </a></h4>
<pre><code class="lang-js">#  echo $-
himBH
</code></pre>
<ul>
<li><code>$-</code>记录着当前设置的shell选项，<code>himBH</code>是默认值，你可以通过 set 命令来设置或者取消一个选项配置。例如：</li>
</ul>
<pre><code class="lang-js">set -x
</code></pre>
<ul>
<li>这个可以打开 shell 的调试开关，调试 shell 脚本非常有用，这个时候再检查下 $- 变量的值，可以看到多了 x 字符：</li>
</ul>
<pre><code class="lang-js">[root@localhost ~]# echo $-
+ echo himxBH
himxBH
</code></pre>
<h4 id="t1076.4.3 选项">6.4.3 选项 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1076.4.3%20%E9%80%89%E9%A1%B9"> # </a></h4>
<ul>
<li>查看当前 shell 的选项配置<pre><code class="lang-js">set -o
</code></pre>
<h5 id="t1086.4.3.1 i - interactive">6.4.3.1 i - interactive <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1086.4.3.1%20i%20-%20interactive"> # </a></h5>
</li>
<li>包含这个选项说明当前的 shell 是一个交互式的 shell，何为交互式？你输入命令，shell 解释执行后给你返回结果，我们在 Terminal 下使用的 shell 就是交互式的 如果我们在一个脚本里面 echo $-，结果是不会包含 i 的</li>
</ul>
<h5 id="t1096.4.3.2 H - history expand">6.4.3.2 H - history expand <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1096.4.3.2%20H%20-%20history%20expand"> # </a></h5>
<ul>
<li>history expand 就是展开历史列表中的命令，可以通过!感叹号来完成，例如"!!"返回上最近的一个历史命令，"!n"返回第 n 个历史命令，等等</li>
</ul>
<h5 id="t1106.4.3.3 B - brace expansion">6.4.3.3 B - brace expansion <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1106.4.3.3%20B%20-%20brace%20expansion"> # </a></h5>
<ul>
<li>大括号扩展，是可以让bash生成任意字符串的一种扩展功能</li>
</ul>
<pre><code class="lang-js">echo g{a,b,c}$
</code></pre>
<h5 id="t1116.4.3.4 m - monitor mode">6.4.3.4 m - monitor mode <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1116.4.3.4%20m%20-%20monitor%20mode"> # </a></h5>
<ul>
<li>打开监控模式,可以控制进程的停止、继续，后台或者前台执行</li>
<li>正常情况下，在交互式模式下，该选项默认是打开的，所以再执行一个比较耗时的命令时，你可以按下<code>CTRL+Z</code> 让它在后台运行，然后可以用 <code>fg</code> 命令将后台运行的任务恢复到前台执行</li>
</ul>
<pre><code class="lang-js"> sleep <span class="hljs-number">10</span>s
</code></pre>
<h5 id="t1126.4.3.5 h - hashal">6.4.3.5 h - hashal <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1126.4.3.5%20h%20-%20hashal"> # </a></h5>
<ul>
<li>Remember  the  location  of  commands  as they are looked up for execution.  This is enabled by default. 记录命令的位置</li>
</ul>
<h4 id="t1136.4.4 删除">6.4.4 删除 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1136.4.4%20%E5%88%A0%E9%99%A4"> # </a></h4>
<p>从左往右看，删除掉 <code>$-</code> 变量的值中第一个 <code>i</code> 字符以及之前的内容</p>
<pre><code class="lang-js">${-#*i}
</code></pre>
<p>%与#号的意义刚好相反，从右往左看，删除掉 $- 变量的值中最后一个 i 字符以及之后的内容</p>
<pre><code class="lang-js">${-%i*}
</code></pre>
<h2 id="t1147.shell实战">7.shell实战 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1147.shell%E5%AE%9E%E6%88%98"> # </a></h2>
<h3 id="t1157.1 注意事项">7.1 注意事项 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1157.1%20%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"> # </a></h3>
<ul>
<li>开头加解释器: #/bin/bash和注释说明</li>
<li>命名建议规则: 变量名大写、局部变量小写，函数名小写，名字体现出实际作用</li>
<li>默认变量是全局的，在函数中变量local指定为局部变量，避免污染其它作用域</li>
<li><code>set -e</code> 遇到执行非0时退出脚本, <code>set -x</code> 打印执行过程</li>
<li>写脚本一定要先测试再上生产环境</li>
</ul>
<h3 id="t1167.2 获取随机字符串或数字">7.2 获取随机字符串或数字 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1167.2%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96%E6%95%B0%E5%AD%97"> # </a></h3>
<ul>
<li><code>-c, --characters=LIST   select only these characters</code></li>
</ul>
<h4 id="t1177.2.1 获取随机8位字符串">7.2.1 获取随机8位字符串 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1177.2.1%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA8%E4%BD%8D%E5%AD%97%E7%AC%A6%E4%B8%B2"> # </a></h4>
<ul>
<li>MD5全称是报文摘要算法（Message-Digest Algorithm 5），此算法对任意长度的信息逐位进行计算，产生一个二进制长度为128位(十六进制长度就是32位)的报文摘要,不同的文件产生相同的报文摘要的可能性是非常非常之小的</li>
</ul>
<pre><code class="lang-js">echo $RANDOM |md5sum|cut -c <span class="hljs-number">1</span><span class="hljs-number">-8</span>
cat /proc/sys/kernel/random/uuid | cut -c <span class="hljs-number">1</span><span class="hljs-number">-8</span>
</code></pre>
<h4 id="t1187.2.2 获取随机8位数字">7.2.2 获取随机8位数字 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1187.2.2%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA8%E4%BD%8D%E6%95%B0%E5%AD%97"> # </a></h4>
<ul>
<li>cksum命令是确保文件从一个系统传输到另一个系统地过程中没有被损坏。这个测试要求校验和在源系统中被计算出来,在目的系统中又被计算一次，两个数字比较，如果校验和相等，则该文件被认为是被正确传输了</li>
<li>%N 十亿分之一秒，纳秒 [000000000，999999999]</li>
</ul>
<pre><code class="lang-js">echo $RANDOM |cksum|cut -c <span class="hljs-number">1</span><span class="hljs-number">-8</span>
date +%N | cut -c <span class="hljs-number">1</span><span class="hljs-number">-8</span>
</code></pre>
<h3 id="t1197.3 定义一个颜色输出字符串函数">7.3 定义一个颜色输出字符串函数 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1197.3%20%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E9%A2%9C%E8%89%B2%E8%BE%93%E5%87%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"> # </a></h3>
<ul>
<li>终端的字符颜色是用转义序列控制的，是文本模式下的系统显示功能</li>
<li>转义序列是以ESC开头,即用\033来完成（ESC的ASCII码用十进制表示是27，用八进制表示就是033）</li>
<li>书写格式: 开头部分：<code>\033[显示方式;前景色;背景色m + 结尾部分：\033[0m</code>
显示方式</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">数值</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">默认值</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">高亮</td>
</tr>
<tr>
<td style="text-align:left">22</td>
<td style="text-align:left">非粗体</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">下划线</td>
</tr>
<tr>
<td style="text-align:left">24</td>
<td style="text-align:left">非下划线</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">闪烁</td>
</tr>
<tr>
<td style="text-align:left">25</td>
<td style="text-align:left">非闪烁</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left">反显</td>
</tr>
<tr>
<td style="text-align:left">27</td>
<td style="text-align:left">非反显</td>
</tr>
</tbody>
</table>
<p>前景色</p>
<table>
<thead>
<tr>
<th style="text-align:left">数值</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">30</td>
<td style="text-align:left">黑色</td>
</tr>
<tr>
<td style="text-align:left">31</td>
<td style="text-align:left">红色</td>
</tr>
<tr>
<td style="text-align:left">32</td>
<td style="text-align:left">绿色</td>
</tr>
<tr>
<td style="text-align:left">33</td>
<td style="text-align:left">黄色</td>
</tr>
<tr>
<td style="text-align:left">34</td>
<td style="text-align:left">蓝色</td>
</tr>
<tr>
<td style="text-align:left">35</td>
<td style="text-align:left">洋红</td>
</tr>
<tr>
<td style="text-align:left">36</td>
<td style="text-align:left">青色</td>
</tr>
<tr>
<td style="text-align:left">37</td>
<td style="text-align:left">白色</td>
</tr>
</tbody>
</table>
<p>背景色</p>
<table>
<thead>
<tr>
<th style="text-align:left">数值</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">40</td>
<td style="text-align:left">黑色</td>
</tr>
<tr>
<td style="text-align:left">41</td>
<td style="text-align:left">红色</td>
</tr>
<tr>
<td style="text-align:left">42</td>
<td style="text-align:left">绿色</td>
</tr>
<tr>
<td style="text-align:left">43</td>
<td style="text-align:left">黄色</td>
</tr>
<tr>
<td style="text-align:left">44</td>
<td style="text-align:left">蓝色</td>
</tr>
<tr>
<td style="text-align:left">45</td>
<td style="text-align:left">洋红</td>
</tr>
<tr>
<td style="text-align:left">46</td>
<td style="text-align:left">青色</td>
</tr>
<tr>
<td style="text-align:left">47</td>
<td style="text-align:left">白色</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">echo -e <span class="hljs-string">"\033[m hello \033[m"</span>
显示方式: 正常    字体前景色：红色  背景色：青色
echo -e <span class="hljs-string">"\033[0;31;46m hello \033[m"</span> 
</code></pre>
<pre><code class="lang-js">#!/bin/bash
#description: test
function echo_color(){
  if [ $1 == "green" ]; then
     echo -e "\033[32;40m$2\033[0m"
  elif [ $1 == "red" ]; then
     echo -e "\033[31;40m$2\033[0m"  
  fi    
}

echo -e "\033[32;40mshell\033[0m"
echo -e "\033[33;40mshell\033[0m"

echo_color red hello
</code></pre>
<h3 id="t1207.4 批量创建用户">7.4 批量创建用户 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1207.4%20%E6%89%B9%E9%87%8F%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"> # </a></h3>
<ul>
<li><code>/dev/null 2&gt;&amp;1</code>  这条命令的意思是将标准输出和错误输出全部重定向到/dev/null中,也就是将产生的所有信息丢弃 </li>
<li><code>command &gt; file 2&gt;file</code> 的意思是将命令所产生的标准输出信息,和错误的输出信息送到<code>file</code>中。 command  &gt; file 2&gt;file 这样的写法,stdout和stderr都直接送到file中, file会被打开两次,这样stdout和stderr会互相覆盖,这样写相当使用了FD1和FD2两个同时去抢占file 的管道</li>
<li><code>command &gt;file 2&gt;&amp;1</code> 这条命令就将stdout直接送向file, stderr 继承了FD1管道后,再被送往file,此时,file 只被打开了一次,也只使用了一个管道FD1,它包括了stdout和stderr的内容</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">符号</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">代表重定向到哪里</td>
</tr>
<tr>
<td style="text-align:left">/dev/null</td>
<td style="text-align:left">代表空设备文件</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">表示stderr标准错误</td>
</tr>
<tr>
<td style="text-align:left">&amp;</td>
<td style="text-align:left">表示等同于的意思，2&gt;&amp;1，表示2的输出重定向等同于1</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">1表示stdout标准输出，系统默认值是1，所以"&gt;/dev/null"等同于 "1&gt;/dev/null"</td>
</tr>
</tbody>
</table>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash</span>
USER_FILE=users.txt
<span class="hljs-keyword">for</span> USER <span class="hljs-keyword">in</span> user{1..5}; <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">if</span> ! id <span class="hljs-variable">$USER</span> &amp;&gt;/dev/null; <span class="hljs-keyword">then</span>
    PASS=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$RANDOM</span> | md5sum | cut -c 1-8)
    useradd <span class="hljs-variable">$USER</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PASS</span> | passwd --stdin <span class="hljs-variable">$USER</span> &amp;&gt; /dev/null
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">$USER</span>\t<span class="hljs-variable">$PASS</span>"</span> &gt;&gt; <span class="hljs-variable">$USER_FILE</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$USER</span> user create successfully."</span>
  <span class="hljs-keyword">else</span>
    echo_color red <span class="hljs-string">"<span class="hljs-variable">$USER</span> already exists."</span>;  
  <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h3 id="t1217.5 检查主机存活状态">7.5 检查主机存活状态 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1217.5%20%E6%A3%80%E6%9F%A5%E4%B8%BB%E6%9C%BA%E5%AD%98%E6%B4%BB%E7%8A%B6%E6%80%81"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">for</span> IP <span class="hljs-keyword">in</span> $@; <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">if</span> ping -c <span class="hljs-number">1</span> $IP &amp;&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span>; then
     echo <span class="hljs-string">"$IP is ok."</span>
  <span class="hljs-keyword">else</span>
     echo <span class="hljs-string">"$IP is wrong!"</span>
  fi
done       
</code></pre>
<h3 id="t1227.6 系统监控">7.6 系统监控 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1227.6%20%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7"> # </a></h3>
<h4 id="t1237.6.1 系统命令">7.6.1 系统命令 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1237.6.1%20%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"> # </a></h4>
<h5 id="t1247.6.1.1 vmstat">7.6.1.1 vmstat <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1247.6.1.1%20vmstat"> # </a></h5>
<ul>
<li>借助<code>vmstat</code>工具来分析CPU统计信息</li>
<li>vmstat(Virtual Memory Statistics 虚拟内存统计) 命令用来显示Linux系统虚拟内存状态，也可以报告关于进程、内存、I/O等系统整体运行状态</li>
<li>vmstat [刷新延时 刷新次数]</li>
</ul>
<pre><code class="lang-js">vmstat <span class="hljs-number">1</span> <span class="hljs-number">3</span>
procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="hljs-keyword">in</span>   cs us sy id wa st
 <span class="hljs-number">1</span>  <span class="hljs-number">0</span>    <span class="hljs-number">532</span> <span class="hljs-number">329932</span>  <span class="hljs-number">99388</span> <span class="hljs-number">459768</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">16</span>    <span class="hljs-number">81</span>   <span class="hljs-number">59</span>   <span class="hljs-number">50</span>  <span class="hljs-number">3</span>  <span class="hljs-number">1</span> <span class="hljs-number">96</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>    
</code></pre>
<h6 id="t1257.6.1.1.1 (procs)进程信息字段">7.6.1.1.1 (procs)进程信息字段 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1257.6.1.1.1%20(procs)%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5"> # </a></h6>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">procs</td>
<td style="text-align:left">r</td>
<td style="text-align:left">等待运行的进程数，数量越大，系统就越繁忙</td>
</tr>
<tr>
<td style="text-align:left">procs</td>
<td style="text-align:left">b</td>
<td style="text-align:left">不可被唤醒的进程数量，数量越大，系统越繁忙</td>
</tr>
</tbody>
</table>
<h6 id="t1267.6.1.1.2 memory(内存信息字段)">7.6.1.1.2 memory(内存信息字段) <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1267.6.1.1.2%20memory(%E5%86%85%E5%AD%98%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)"> # </a></h6>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">memory</td>
<td style="text-align:left">swpd</td>
<td style="text-align:left">使用的Swap空间的大小，单位KB</td>
</tr>
<tr>
<td style="text-align:left">memory</td>
<td style="text-align:left">free</td>
<td style="text-align:left">空闲的内存容量，单位KB</td>
</tr>
<tr>
<td style="text-align:left">memory</td>
<td style="text-align:left">buff</td>
<td style="text-align:left">缓冲的内存容量，单位KB</td>
</tr>
<tr>
<td style="text-align:left">memory</td>
<td style="text-align:left">cache</td>
<td style="text-align:left">缓存的内存容量，单位KB</td>
</tr>
</tbody>
</table>
<h6 id="t1277.6.1.1.3 swap(交换分区信息)">7.6.1.1.3 swap(交换分区信息) <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1277.6.1.1.3%20swap(%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF)"> # </a></h6>
<ul>
<li>如果说si和so数越大说明数据经常要在磁盘和内存之间数据交换，系统性能就会越差</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">swap</td>
<td style="text-align:left">si(in)</td>
<td style="text-align:left">从磁盘中交换到内存中的数据的数量，单位KB</td>
</tr>
<tr>
<td style="text-align:left">swap</td>
<td style="text-align:left">so(out)</td>
<td style="text-align:left">从内存中交换到硬盘中的数据的数量，单位KB</td>
</tr>
</tbody>
</table>
<h6 id="t1287.6.1.1.4 io(磁盘读写)">7.6.1.1.4 io(磁盘读写) <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1287.6.1.1.4%20io(%E7%A3%81%E7%9B%98%E8%AF%BB%E5%86%99)"> # </a></h6>
<ul>
<li>bi和bo数越大，说明磁盘的I/O越繁忙</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">io</td>
<td style="text-align:left">bi(in)</td>
<td style="text-align:left">从块设备读入数据的问题，单位是块</td>
</tr>
<tr>
<td style="text-align:left">io</td>
<td style="text-align:left">bo(out)</td>
<td style="text-align:left">写到块设备的数据的总量，单位是块</td>
</tr>
</tbody>
</table>
<h6 id="t1297.6.1.1.5 system(系统信息字段)">7.6.1.1.5 system(系统信息字段) <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1297.6.1.1.5%20system(%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)"> # </a></h6>
<ul>
<li>in和cs数越大，说明系统与接口设备的通信越繁忙</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">system</td>
<td style="text-align:left">in(interrupt)</td>
<td style="text-align:left">每秒被中断的进程次数</td>
</tr>
<tr>
<td style="text-align:left">system</td>
<td style="text-align:left">cs(switch)</td>
<td style="text-align:left">每秒钟进行的事件切换次数</td>
</tr>
</tbody>
</table>
<h6 id="t1307.6.1.1.6 CPU(CPU信息字段)">7.6.1.1.6 CPU(CPU信息字段) <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1307.6.1.1.6%20CPU(CPU%E4%BF%A1%E6%81%AF%E5%AD%97%E6%AE%B5)"> # </a></h6>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CPU</td>
<td style="text-align:left">us(user)</td>
<td style="text-align:left">非内核进程消耗CPU运算时间的百分比</td>
</tr>
<tr>
<td style="text-align:left">CPU</td>
<td style="text-align:left">sy(system)</td>
<td style="text-align:left">内核进程消耗CPU运算时间的百分比</td>
</tr>
<tr>
<td style="text-align:left">CPU</td>
<td style="text-align:left">id(idea)</td>
<td style="text-align:left">空闲CPU的百分比</td>
</tr>
<tr>
<td style="text-align:left">CPU</td>
<td style="text-align:left">wa(wait)</td>
<td style="text-align:left">等待I/O所消耗的CPU百分比</td>
</tr>
<tr>
<td style="text-align:left">CPU</td>
<td style="text-align:left">st(steal)</td>
<td style="text-align:left">被虚拟机偷走的CPU百分比</td>
</tr>
</tbody>
</table>
<h5 id="t1317.6.1.2 free">7.6.1.2 free <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1317.6.1.2%20free"> # </a></h5>
<ul>
<li>查看内存使用状态</li>
<li>free [-b|-k|-m|-g]</li>
</ul>
<p>选项
|参数名称|参数含义|
|:----|:----|
|-b|以字节为单位|
|-k|以KB字节为单位|
|-m|以MB字节为单位|
|-g|以GB字节为单位|</p>
<pre><code class="lang-js"># free -m
             total       used       free     shared    buffers     cached
Mem:          1006        687        319          0         98        449
-/+ buffers/cache:        139        866
Swap:         1999          0       1999
</code></pre>
<h6 id="t1327.6.1.2.1 第一行">7.6.1.2.1 第一行 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1327.6.1.2.1%20%E7%AC%AC%E4%B8%80%E8%A1%8C"> # </a></h6>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">total</td>
<td style="text-align:left">内存总数,total=used+free</td>
</tr>
<tr>
<td style="text-align:left">used</td>
<td style="text-align:left">已经使用的内存数</td>
</tr>
<tr>
<td style="text-align:left">free</td>
<td style="text-align:left">空闲的内存数</td>
</tr>
<tr>
<td style="text-align:left">shared</td>
<td style="text-align:left">多个进程共享的内存数,0，废弃，永远为0</td>
</tr>
<tr>
<td style="text-align:left">buffers</td>
<td style="text-align:left">缓冲区内存数,buffer用于作为写入磁盘的内容缓冲区</td>
</tr>
<tr>
<td style="text-align:left">cached</td>
<td style="text-align:left">缓存内存数,用于从磁盘中读取的内容缓存</td>
</tr>
</tbody>
</table>
<h6 id="t1337.6.1.2.2 第二行">7.6.1.2.2 第二行 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1337.6.1.2.2%20%E7%AC%AC%E4%BA%8C%E8%A1%8C"> # </a></h6>
<ul>
<li>用于指示应用程序看到的内存情况，也就是应用程序获取内存大小</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">算法</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">- buffers/cache</td>
<td style="text-align:left">第一行的used-buffers-cached</td>
<td style="text-align:left">已经使用的要减去缓存和缓冲的内存量</td>
</tr>
<tr>
<td style="text-align:left">+ buffers/cache</td>
<td style="text-align:left">第一行的free+buffers+cached</td>
<td style="text-align:left">空闲的要加上缓存和缓冲的内存量</td>
</tr>
</tbody>
</table>
<h6 id="t1347.6.1.2.3 第三行">7.6.1.2.3 第三行 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1347.6.1.2.3%20%E7%AC%AC%E4%B8%89%E8%A1%8C"> # </a></h6>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">total</td>
<td style="text-align:left">swap总数，默认单位是K</td>
</tr>
<tr>
<td style="text-align:left">used</td>
<td style="text-align:left">已经使用的swap数，默认单位是K</td>
</tr>
<tr>
<td style="text-align:left">free</td>
<td style="text-align:left">空闲的swap数，默认单位是K</td>
</tr>
</tbody>
</table>
<h5 id="t1357.6.1.3 查询网络状态">7.6.1.3 查询网络状态 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1357.6.1.3%20%E6%9F%A5%E8%AF%A2%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81"> # </a></h5>
<ul>
<li>netstat 选项</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-t</td>
<td style="text-align:left">列出TCP协议端口</td>
</tr>
<tr>
<td style="text-align:left">-u</td>
<td style="text-align:left">列出UDP协议端口</td>
</tr>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">不使用域名与服务名，而使用IP地址和端口号</td>
</tr>
<tr>
<td style="text-align:left">-l</td>
<td style="text-align:left">仅列出在监听状态网络服务</td>
</tr>
<tr>
<td style="text-align:left">-a</td>
<td style="text-align:left">列出所有的网络连接</td>
</tr>
</tbody>
</table>
<pre><code class="lang-js">netstat -tlun
netstat -an | more
netstat -unt | grep  ESTABLISHED
</code></pre>
<h4 id="t1367.6.2 函数">7.6.2 函数 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1367.6.2%20%E5%87%BD%E6%95%B0"> # </a></h4>
<h5 id="t1377.6.2.1 cpu">7.6.2.1 cpu <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1377.6.2.1%20cpu"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
cpu(){
    local user system idle cwait
    user=$(vmstat | awk <span class="hljs-string">'NR==3{print $13}'</span>)
    system=$(vmstat | awk <span class="hljs-string">'NR==3{print $14}'</span>)
    idea=$(vmstat | awk <span class="hljs-string">'NR==3{print $15}'</span>)
    cwait=$(vmstat | awk <span class="hljs-string">'NR==3{print $16}'</span>)
    echo <span class="hljs-string">"user cpu: $user%"</span>
    echo <span class="hljs-string">"system cpu: $system%"</span>
    echo <span class="hljs-string">"idle cpu: $idea%"</span>
    echo <span class="hljs-string">"wait: $cwait%"</span>
}
cpu
</code></pre>
<h5 id="t1387.6.2.2 memory">7.6.2.2 memory <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1387.6.2.2%20memory"> # </a></h5>
<pre><code class="lang-js">memory(){
  local total used free
  used=$(free -m | awk <span class="hljs-string">'NR==3{print $3}'</span>)
  free=$(free -m | awk <span class="hljs-string">'NR==3{print $4}'</span>)
  total=$(($used+$free))
  echo <span class="hljs-string">"内存总计: ${total}M"</span>
  echo <span class="hljs-string">"内存使用: ${used}M"</span>
  echo <span class="hljs-string">"内存剩余: ${free}M"</span>
}
memory
</code></pre>
<h5 id="t1397.6.2.3 disk">7.6.2.3 disk <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1397.6.2.3%20disk"> # </a></h5>
<pre><code class="lang-js">disk(){
  local mount total used used_percent free
  partitions=$(df -h|awk <span class="hljs-string">'BEGIN{OFS="="}/^\/dev/{print $6,$2,$3,$4,$5}'</span>)
  echo $p
  <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span>  $partitions; <span class="hljs-keyword">do</span>
    mount=$(echo $p | cut -d<span class="hljs-string">"="</span> -f1)
    total=$(echo $p | cut -d<span class="hljs-string">"="</span> -f2)
    used=$(echo $p | cut -d<span class="hljs-string">"="</span> -f3)
    free=$(echo $p | cut -d<span class="hljs-string">"="</span> -f4)
    used_percent=$(echo $p | cut -d<span class="hljs-string">"="</span> -f5|cut -d<span class="hljs-string">"%"</span> -f1)
    <span class="hljs-keyword">if</span> [ $used_percent -ge <span class="hljs-number">5</span> ]; then
      echo <span class="hljs-string">"挂载点=$mount,总大小=$total,使用大小=$used,空闲大小=$free,使用百分比=$used_percent%"</span>
    fi  
  done
}
</code></pre>
<h3 id="t1407.7 监控网络流量">7.7 监控网络流量 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1407.7%20%E7%9B%91%E6%8E%A7%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F"> # </a></h3>
<pre><code class="lang-js">network(){
    local old_in old_out new_in new_out
    old_in=$(ifconfig ens33 | awk <span class="hljs-string">'/RX/&amp;&amp;/bytes/{print $5}'</span>)
    old_out=$(ifconfig ens33 | awk <span class="hljs-string">'/TX/&amp;&amp;/bytes/{print $5}'</span>)
    sleep <span class="hljs-number">1</span>s
    new_in=$(ifconfig ens33 | awk <span class="hljs-string">'/RX/&amp;&amp;/bytes/{print $5}'</span>)
    new_out=$(ifconfig ens33 | awk <span class="hljs-string">'/TX/&amp;&amp;/bytes/{print $5}'</span>)
    <span class="hljs-keyword">in</span>=$(($new_in-$old_in))
    out=$(($new_out-$old_out))
    echo <span class="hljs-string">"$1 入口流量=${in}bytes/s 出口流量=${out}bytes/s"</span>
}
network
</code></pre>
<h3 id="t1417.8 监控网站状态">7.8 监控网站状态 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1417.8%20%E7%9B%91%E6%8E%A7%E7%BD%91%E7%AB%99%E7%8A%B6%E6%80%81"> # </a></h3>
<ul>
<li>-w 可以获取一些变量的值</li>
</ul>
<pre><code class="lang-js">curl -o /dev/<span class="hljs-literal">null</span> -s -w <span class="hljs-string">"%{http_code}"</span> http:<span class="hljs-comment">//www.baidu.com</span>


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_url</span>(<span class="hljs-params"></span>)</span>{
    HTTP_CODE=$(curl -o /dev/<span class="hljs-literal">null</span> -s -w <span class="hljs-string">"%{http_code}"</span> $<span class="hljs-number">1</span>)
    <span class="hljs-keyword">if</span> [ $HTTP_CODE -ne <span class="hljs-number">200</span> ]; then
      echo <span class="hljs-string">"$1不可达"</span>
    <span class="hljs-keyword">else</span>
      echo <span class="hljs-string">"$1状态正常"</span>  
    fi
}
</code></pre>
<h3 id="t1427.9 监控nginx状态">7.9 监控nginx状态 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1427.9%20%E7%9B%91%E6%8E%A7nginx%E7%8A%B6%E6%80%81"> # </a></h3>
<h4 id="t1437.9.1 本地安装nginx">7.9.1 本地安装nginx <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1437.9.1%20%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85nginx"> # </a></h4>
<pre><code class="lang-js">rpm -Uvh http:<span class="hljs-comment">//nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span>
yum install -y nginx
systemctl start nginx.service
systemctl status  nginx.service
</code></pre>
<h4 id="t1447.9.2 监控脚本">7.9.2 监控脚本 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1447.9.2%20%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
local nginx
nginx=<span class="hljs-string">`ps -ef |grep nginx|grep -v grep|wc -l`</span>
 <span class="hljs-keyword">if</span> [ $nginx -gt <span class="hljs-number">2</span> ];then
    echo <span class="hljs-string">"your nginx is running"</span>
    exit <span class="hljs-number">0</span>
 <span class="hljs-keyword">else</span>
    /bin/systemctl start nginx.service
    exit <span class="hljs-number">1</span>
fi
</code></pre>
<h3 id="t1457.10 监控mysql状态">7.10 监控mysql状态 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1457.10%20%E7%9B%91%E6%8E%A7mysql%E7%8A%B6%E6%80%81"> # </a></h3>
<h4 id="t1467.10.1 本地安装mysql">7.10.1 本地安装mysql <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1467.10.1%20%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85mysql"> # </a></h4>
<pre><code class="lang-js">wget -i -c http:<span class="hljs-comment">//dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span>
yum -y install mysql57-community-release-el7<span class="hljs-number">-10.</span>noarch.rpm
yum -y install mysql-community-server
systemctl start  mysqld.service
systemctl status mysqld.service


mysql -uroot -p
</code></pre>
<h4 id="t1477.10.2 默认密码和忘记密码">7.10.2 默认密码和忘记密码 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1477.10.2%20%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E5%92%8C%E5%BF%98%E8%AE%B0%E5%AF%86%E7%A0%81"> # </a></h4>
<pre><code class="lang-js">cat  /<span class="hljs-keyword">var</span>/log/mysqld.log | grep  temporary

<span class="hljs-number">1.</span> 修改/etc/my.conf, 添加参数skip-grant-tables
systemctl restart mysqld.service
mysql -uroot
use mysql
update user set authentication_string=PASSWORD(<span class="hljs-string">'123456'</span>) where User=<span class="hljs-string">'root'</span>;
alter user <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> identified by <span class="hljs-string">'Zfpx2019@qq.com'</span>;
</code></pre>
<h4 id="t1487.10.3 监控脚本">7.10.3 监控脚本 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1487.10.3%20%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/sh</span>
PortNum=<span class="hljs-string">`netstat -lnt|grep 3306|wc -l`</span>
<span class="hljs-keyword">if</span> [ $PortNum -eq <span class="hljs-number">1</span> ]
then
 echo <span class="hljs-string">"mysqld is running."</span>
<span class="hljs-keyword">else</span>
 echo <span class="hljs-string">"mysqld is stoped."</span>
fi
</code></pre>
<h3 id="t1497.11 mysql备份脚本">7.11 mysql备份脚本 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1497.11%20mysql%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-meta">#!/bin/bash</span>
DATE=$(date +%F_%H-%M-%S)
HOST=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
DB=test
USER=root
PASS=Zfpx2019@qq.com
MAIL=<span class="hljs-string">"83687401@qq.com"</span>
BACKUP_DIR=<span class="hljs-regexp">/data/</span>db_backup
<span class="hljs-keyword">if</span> [ ! -d <span class="hljs-string">"$BACKUP_DIR"</span> ];then
 mkdir -p $BACKUP_DIR
fi
SQL_FILE=${DB}_FULL_$DATE.sql
BAK_FILE=${DB}_FULL_$DATE.zip
cd $BACKUP_DIR
<span class="hljs-keyword">if</span> mysqldump -h$HOST -u$USER -p$PASS -B $DB &gt; $SQL_FILE; then
  zip $BAK_FILE $SQL_FILE &amp;&amp; rm -rf $SQL_FILE
  <span class="hljs-keyword">if</span> [ ! -s $BAK_FILE ]; then
    echo <span class="hljs-string">"$DATE 备份失败"</span> | mail -s <span class="hljs-string">"备份失败"</span> $MAIL
  fi
<span class="hljs-keyword">else</span>
  echo <span class="hljs-string">"$DATE 备份失败"</span> | mail -s <span class="hljs-string">"备份失败"</span> $MAIL
fi
find $BACKUP_DIR -name <span class="hljs-string">'*.zip'</span> -ctime +<span class="hljs-number">14</span> -exec rm {} \;
</code></pre>
<h2 id="t1508. 附录">8. 附录 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1508.%20%E9%99%84%E5%BD%95"> # </a></h2>
<h3 id="t1518.1.  Linux特殊文件">8.1.  Linux特殊文件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1518.1.%20%20Linux%E7%89%B9%E6%AE%8A%E6%96%87%E4%BB%B6"> # </a></h3>
<h4 id="t1528.1.1 块设备">8.1.1 块设备 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1528.1.1%20%E5%9D%97%E8%AE%BE%E5%A4%87"> # </a></h4>
<ul>
<li>块设备：系统能够随机无序访问固定大小的数据片的设备，这些数据片称为块。块设备是以固定大小长度来传送资料的，它使用缓冲区暂存数据，时机成熟后从缓存中一次性写入到设备或者从设备中一次性放到缓存区。常见的块设备有硬盘、CD-ROM驱动器、Flash闪存等等，它们也是通过文件形式存在于Linux中的。Linux以<code>b</code>(block)表示块设备</li>
</ul>
<pre><code class="lang-js"># ll /dev/sr0
brw-rw----.   /dev/sr0

</code></pre>
<h4 id="t1538.1.2 字符设备">8.1.2 字符设备 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1538.1.2%20%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87"> # </a></h4>
<ul>
<li>字符设备：按照字符流方式被有序访问，以不定长度的字符传送资料，不存在缓冲区，所以对这种设备的读写都是实时的，比如键盘等等。Linux以<code>c</code>(char)表示字符设备</li>
</ul>
<pre><code class="lang-js"># ll /dev/input/mouse0
crw-r-----.   /dev/input/mouse0
# ll /dev/input/event0
crw-r-----.  /dev/input/event0
</code></pre>
<h4 id="t1548.1.3 管道文件">8.1.3 管道文件 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1548.1.3%20%E7%AE%A1%E9%81%93%E6%96%87%E4%BB%B6"> # </a></h4>
<ul>
<li>管道文件是linux下的一种特殊缓存文件,所谓缓存就是只会存在于进程执行的时候，进程关闭管道文件也关闭了,管道文件要在读写的时候，先阻塞在写操作的open函数，当有读操作进来的时候，通信链路建立，写操作开始往管道里写东西，写完成之后，在读操作会把东西读出来，最后两个进程都正常结束退出,Linux以<code>p</code>(pipe)表示管道设备</li>
</ul>
<pre><code class="lang-js">find / -type p
ll /<span class="hljs-keyword">var</span>/run/autofs.fifo-misc
</code></pre>
<h4 id="t1558.1.4 套接字">8.1.4 套接字 <a href="http://www.zhufengpeixun.cn/architecture/html/61.5.devops-shell.html#t1558.1.4%20%E5%A5%97%E6%8E%A5%E5%AD%97"> # </a></h4>
<ul>
<li>套接字Socket看做是不同主机之间的进程进行双向通信的端点，简单的说就是通信的两方的一种约定，用套接字中的相关函数来完成通信过程。套接字Socket是连接应用程序和网络驱动程序的桥梁，套接字Socket在应用程序中创建，通过绑定与网络驱动建立关系。此后，应用程序送给套接字Socket的数据，由套接字Socket交给网络驱动程序向网络上发送出去。计算机从网络上收到与该套接字Socket绑定IP地址和端口号相关的数据后，由网络驱动程序交给Socket，应用程序便可从该Socket中提取接收到的数据，网络应用程序就是这样通过Socket进行数据的发送与接收的。Linux以<code>S</code>(Socket)表示套接字设备</li>
</ul>
<pre><code class="lang-js">[root@localhost input]# ll /tmp/mysql.sock
srwxrwxrwx. 1 mysql mysql 0 4月   6 12:18 /tmp/mysql.sock
[root@localhost input]# ll /var/run/cups/cups.sock
srwxrwxrwx. 1 root root 0 4月   6 17:51 /var/run/cups/cups.sock
</code></pre>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org/">Node.js</a> run.</div>
    </div>
    
</div>

<script src="./61.5.devops-shell_files/jquery.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})

$('.logo').on('mouseenter',function(){
  $('.nav').height('400px');
})
$('.nav').on('mouseleave',function(){
  $('.nav').height('80px');
})
$('.logo').on('click',function(){
  $('.nav').css('display','none');
 $('.warpper').css('padding','0px');
})
// if (!$('.understand-me').length) {
  //   var bar = $(window).height() - $('.navbar ').height() - $('.page-toc').position().top;
  //   var count = bar / 26 / 2;
  //   var barHeight = $('.page-toc').outerHeight();
  //   $('.page-toc li').eq(0).children('a').addClass('red');
  //   var arr = [];
  //   $("h1,h2,h3,h4,h5,h6").each(function () {
  //     arr.push($(this).position().top);
  //   });
  //   var timer
  //   function dark() {
  //     clearTimeout(timer)
  //      timer = setTimeout(function () {
  //      var top = Math.abs($('.page-toc > ul').position().top);
  //      var cur = $('.content').scrollTop();
  //      for (var i = arr.length; i >= 0; i--) {
  //        if (arr[i] <= cur) {
  //          break;
  //        }
  //      }
  //      if (i === -1) {
  //        i = 0;
  //      }
  //      $('.page-toc li a').removeClass('red');
  //      $('.page-toc li').eq(i).children('a').addClass('red');
  //      let height = $('.page-toc li').eq(i).position().top-$('.page-toc').height(); // 如果当前的offset出去了 回到中间可好？
  //      $('.page-toc').scrollTop(height+$('.page-toc').height()/2);
  //    },200)
  //   }

  //   $('.content').on('scroll', dark);
  // }
</script>
<style>

    /* ::-webkit-scrollbar{width:14px;}
    ::-webkit-scrollbar-track{background-color:transparent;}
    ::-webkit-scrollbar-thumb{background-color:transparent;}
    ::-webkit-scrollbar-thumb:hover {background-color:transparent}
    ::-webkit-scrollbar-thumb:active {background-color:transparent} */

    .page-toc > ul .red {
        background: #f3f3f3;
        z-index: 1;
        border-left: 3px solid #009a61;
        -webkit-transition: all .2s ease;
        transition: all .2s ease;
        color: #000
    }





</style>


</body></html>